

<!DOCTYPE html>
<html lang="zh-cn" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="xrt">
  <meta name="keywords" content="">
  <meta name="description" content="SpringMVC在前面学习完Spring框架技术之后，差不多会出现两批人：一批是听得云里雾里，依然不明白这个东西是干嘛的；还有一批就是差不多理解了核心思想，但是不知道这些东西该如何去发挥它的作用。在SpringMVC阶段，你就能逐渐够体会到Spring框架为我们带来的便捷之处了。 此阶段，我们将再次回到Tomcat的Web应用程序开发中，去感受SpringMVC为我们带来的巨大便捷。 MVC理">
<meta property="og:type" content="article">
<meta property="og:title" content="XRTing&#39;s Blog">
<meta property="og:url" content="http://blurryf.github.io/2022/04/23/3.html/index.html">
<meta property="og:site_name" content="XRTing&#39;s Blog">
<meta property="og:description" content="SpringMVC在前面学习完Spring框架技术之后，差不多会出现两批人：一批是听得云里雾里，依然不明白这个东西是干嘛的；还有一批就是差不多理解了核心思想，但是不知道这些东西该如何去发挥它的作用。在SpringMVC阶段，你就能逐渐够体会到Spring框架为我们带来的便捷之处了。 此阶段，我们将再次回到Tomcat的Web应用程序开发中，去感受SpringMVC为我们带来的巨大便捷。 MVC理">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fpic4.zhimg.com%2Fv2-37ff43e92267558c2fbaa70aedbfc133_1200x500.jpg&refer=http%3A%2F%2Fpic4.zhimg.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1641702986&t=9a8080a4683d1e65b0b5e6f1ac764dfe">
<meta property="og:image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fs4.51cto.com%2Fwyfs02%2FM00%2F8B%2FBA%2FwKioL1hXU8vRX8elAAA2bXqAxMs799.png&refer=http%3A%2F%2Fs4.51cto.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1641788288&t=1658084627505c12812596d8ca1b9885">
<meta property="og:image" content="https://pics5.baidu.com/feed/d0c8a786c9177f3e5707320277aeb1c39f3d5677.jpeg?token=e4c298063f4efa11fd0f94c2760c252b&s=782834721BC044435C55F4CA0000E0B1">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/738818/201906/738818-20190617214214614-761905677.png">
<meta property="og:image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg2018.cnblogs.com%2Fblog%2F1190675%2F201812%2F1190675-20181203121258033-524477408.png&refer=http%3A%2F%2Fimg2018.cnblogs.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1642058685&t=13fd16796a8b5ed58762c9947f15681f">
<meta property="og:image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F4685968-ca4e9021f653c954.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240&refer=http%3A%2F%2Fupload-images.jianshu.io&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1642340637&t=70d3dd6b52ae01ac76c04d99e6bd95ed">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1758707/201908/1758707-20190814212141691-1998020800.png">
<meta property="og:image" content="https://www.runoob.com/wp-content/uploads/2013/09/ajax-yl.png">
<meta property="og:image" content="https://images2018.cnblogs.com/blog/1290804/201712/1290804-20171209164442730-1374080285.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1338162/201901/1338162-20190113192808388-307235311.png">
<meta property="article:published_time" content="2022-04-23T03:19:02.934Z">
<meta property="article:modified_time" content="2022-04-23T03:19:02.989Z">
<meta property="article:author" content="xrt">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fpic4.zhimg.com%2Fv2-37ff43e92267558c2fbaa70aedbfc133_1200x500.jpg&refer=http%3A%2F%2Fpic4.zhimg.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1641702986&t=9a8080a4683d1e65b0b5e6f1ac764dfe">
  
  <title>XRTing&#39;s Blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"blurryf.github.io","root":"/","version":"1.8.12","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname"}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>XRTing</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-04-23 11:19" pubdate>
        2022年4月23日 上午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      39k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      122 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none"></h1>
            
            <div class="markdown-body">
              <p><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fpic4.zhimg.com%2Fv2-37ff43e92267558c2fbaa70aedbfc133_1200x500.jpg&refer=http%3A%2F%2Fpic4.zhimg.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1641702986&t=9a8080a4683d1e65b0b5e6f1ac764dfe" srcset="/img/loading.gif" lazyload alt="img"></p>
<h1 id="SpringMVC"><a href="#SpringMVC" class="headerlink" title="SpringMVC"></a>SpringMVC</h1><p>在前面学习完Spring框架技术之后，差不多会出现两批人：一批是听得云里雾里，依然不明白这个东西是干嘛的；还有一批就是差不多理解了核心思想，但是不知道这些东西该如何去发挥它的作用。在SpringMVC阶段，你就能逐渐够体会到Spring框架为我们带来的便捷之处了。</p>
<p>此阶段，我们将再次回到Tomcat的Web应用程序开发中，去感受SpringMVC为我们带来的巨大便捷。</p>
<h2 id="MVC理论基础"><a href="#MVC理论基础" class="headerlink" title="MVC理论基础"></a>MVC理论基础</h2><p>在之前，我们给大家讲解了三层架构，包括：</p>
<p><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fs4.51cto.com%2Fwyfs02%2FM00%2F8B%2FBA%2FwKioL1hXU8vRX8elAAA2bXqAxMs799.png&refer=http%3A%2F%2Fs4.51cto.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1641788288&t=1658084627505c12812596d8ca1b9885" srcset="/img/loading.gif" lazyload alt="点击查看源网页"></p>
<p>每一层都有着各自的职责，其中最关键的当属表示层，因为它相当于就是直接与用户的浏览器打交道的一层，并且所有的请求都会经过它进行解析，然后再告知业务层进行处理，任何页面的返回和数据填充也全靠表示层来完成，因此它实际上是整个三层架构中最关键的一层，而在之前的实战开发中，我们编写了大量的Servlet（也就是表示层实现）来处理来自浏览器的各种请求，但是我们发现，仅仅是几个很小的功能，以及几个很基本的页面，我们都要编写将近十个Servlet，如果是更加大型的网站系统，比如淘宝、B站，光是一个页面中可能就包含了几十甚至上百个功能，想想那样的话写起来得多恐怖。</p>
<p>因此，SpringMVC正是为了解决这种问题而生的，它是一个非常优秀的表示层框架（在此之前还有一个叫做Struts2的框架，但是现阶段貌似快凉透了），采用MVC思想设计实现。</p>
<p>MVC解释如下：</p>
<ul>
<li>M是指业务模型（Model）：通俗的讲就是我们之前用于封装数据传递的实体类。</li>
<li>V是指用户界面（View）：一般指的是前端页面。</li>
<li>C则是控制器（Controller）：控制器就相当于Servlet的基本功能，处理请求，返回响应。</li>
</ul>
<p><img src="https://pics5.baidu.com/feed/d0c8a786c9177f3e5707320277aeb1c39f3d5677.jpeg?token=e4c298063f4efa11fd0f94c2760c252b&s=782834721BC044435C55F4CA0000E0B1" srcset="/img/loading.gif" lazyload alt="点击查看源网页"></p>
<p>SpringMVC正是希望这三者之间进行解耦，实现各干各的，更加精细地划分对应的职责。最后再将View和Model进行渲染，得到最终的页面并返回给前端（就像之前使用Thymeleaf那样，把实体数据对象和前端页面都给到Thymeleaf，然后它会将其进行整合渲染得到最终有数据的页面，而本教程也会使用Thymeleaf作为视图解析器进行讲解）</p>
<hr>
<h2 id="配置环境并搭建项目"><a href="#配置环境并搭建项目" class="headerlink" title="配置环境并搭建项目"></a>配置环境并搭建项目</h2><p>由于SpringMVC还没有支持最新的Tomcat10（主要是之前提到的包名问题，神仙打架百姓遭殃）所以我们干脆就再来配置一下Tomcat9环境，相当于回顾一下。</p>
<p>下载地址：<a target="_blank" rel="noopener" href="https://tomcat.apache.org/download-90.cgi">https://tomcat.apache.org/download-90.cgi</a></p>
<p>添加SpringMVC的依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-webmvc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.3.13<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name"><code class="language-hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-webmvc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.3.13<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>></span><br></code></pre></td></tr></table></figure>

<p>接着我们需要配置一下web.xml，将DispatcherServlet替换掉Tomcat自带的Servlet，这里url-pattern需要写为<code>/</code>，即可完成替换：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre class=" language-hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;4.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>mvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>mvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name"><code class="language-hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;4.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>mvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>mvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>></span><br></code></pre></td></tr></table></figure>

<p>接着需要为整个Web应用程序配置一个Spring上下文环境（也就是容器），因为SpringMVC是基于Spring开发的，它直接利用Spring提供的容器来实现各种功能，这里我们直接使用注解方式进行配置，不再使用XML配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre class=" language-hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>com.example.config.MvcConfiguration<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextClass<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>org.springframework.web.context.support.AnnotationConfigWebApplicationContext<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name"><code class="language-hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>com.example.config.MvcConfiguration<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextClass<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>org.springframework.web.context.support.AnnotationConfigWebApplicationContext<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>></span><br></code></pre></td></tr></table></figure>

<p>如果还是想使用XML配置文件进行配置，那么可以直接这样写：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>配置文件名称<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name"><code class="language-hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>配置文件名称<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>></span><br></code></pre></td></tr></table></figure>

<p>如果你希望完完全全丢弃配置文件，可以直接添加一个类，Tomcat会在类路径中查找实现ServletContainerInitializer 接口的类，如果发现的话，就用它来配置Servlet容器，Spring提供了这个接口的实现类 SpringServletContainerInitializer , 通过@HandlesTypes(WebApplicationInitializer.class)设置，这个类反过来会查找实现WebApplicationInitializer 的类，并将配置的任务交给他们来完成，因此直接实现接口即可：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainInitializer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractAnnotationConfigDispatcherServletInitializer</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> Class&lt;?&gt;[] getRootConfigClasses() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Class[]&#123;MainConfiguration.class&#125;;   <span class="hljs-comment">//基本的Spring配置类，一般用于业务层配置</span><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Class[<span class="hljs-number">0</span>];  <span class="hljs-comment">//配置DispatcherServlet的配置类、主要用于Controller等配置</span><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> String[] getServletMappings() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> String[]&#123;<span class="hljs-string">&quot;/&quot;</span>&#125;;    <span class="hljs-comment"><code class="language-hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainInitializer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractAnnotationConfigDispatcherServletInitializer</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> Class&lt;?&gt;[] getRootConfigClasses() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Class[]&#123;MainConfiguration.class&#125;;   <span class="hljs-comment">//基本的Spring配置类，一般用于业务层配置</span><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Class[<span class="hljs-number">0</span>];  <span class="hljs-comment">//配置DispatcherServlet的配置类、主要用于Controller等配置</span><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> String[] getServletMappings() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> String[]&#123;<span class="hljs-string">&quot;/&quot;</span>&#125;;    <span class="hljs-comment">//匹配路径，与上面一致</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>顺便编写一下最基本的配置类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title"><code class="language-hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainConfiguration</span> </span>&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>后面我们都采用无XML配置方式进行讲解。</p>
<p><img src="https://img2018.cnblogs.com/blog/738818/201906/738818-20190617214214614-761905677.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>这样，就完成最基本的配置了，现在任何请求都会优先经过<code>DispatcherServlet</code>进行集中处理，下面我们会详细讲解如何使用它。</p>
<hr>
<h2 id="Controller控制器"><a href="#Controller控制器" class="headerlink" title="Controller控制器"></a>Controller控制器</h2><p>有了SpringMVC之后，我们不必再像之前那样一个请求地址创建一个Servlet了，它使用<code>DispatcherServlet</code>替代Tomcat为我们提供的默认的静态资源Servlet，也就是说，现在所有的请求（除了jsp，因为Tomcat还提供了一个jsp的Servlet）都会经过<code>DispatcherServlet</code>进行处理。</p>
<p>那么<code>DispatcherServlet</code>会帮助我们做什么呢？</p>
<p><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg2018.cnblogs.com%2Fblog%2F1190675%2F201812%2F1190675-20181203121258033-524477408.png&refer=http%3A%2F%2Fimg2018.cnblogs.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1642058685&t=13fd16796a8b5ed58762c9947f15681f" srcset="/img/loading.gif" lazyload alt="点击查看源网页"></p>
<p>根据图片我们可以了解，我们的请求到达Tomcat服务器之后，会交给当前的Web应用程序进行处理，而SpringMVC使用<code>DispatcherServlet</code>来处理所有的请求，也就是说它被作为一个统一的访问点，所有的请求全部由它来进行调度。</p>
<p>当一个请求经过<code>DispatcherServlet</code>之后，会先走<code>HandlerMapping</code>，它会将请求映射为<code>HandlerExecutionChain</code>，依次经过<code>HandlerInterceptor</code>有点类似于之前我们所学的过滤器，不过在SpringMVC中我们使用的是拦截器，然后再交给<code>HandlerAdapter</code>，根据请求的路径选择合适的控制器进行处理，控制器处理完成之后，会返回一个<code>ModelAndView</code>对象，包括数据模型和视图，通俗的讲就是页面中数据和页面本身（只包含视图名称即可）。</p>
<p>返回<code>ModelAndView</code>之后，会交给<code>ViewResolver</code>（视图解析器）进行处理，视图解析器会对整个视图页面进行解析，SpringMVC自带了一些视图解析器，但是只适用于JSP页面，我们也可以像之前一样使用Thymeleaf作为视图解析器，这样我们就可以根据给定的视图名称，直接读取HTML编写的页面，解析为一个真正的View。</p>
<p>解析完成后，就需要将页面中的数据全部渲染到View中，最后返回给<code>DispatcherServlet</code>一个包含所有数据的成形页面，再响应给浏览器，完成整个过程。</p>
<p>因此，实际上整个过程我们只需要编写对应请求路径的的Controller以及配置好我们需要的ViewResolver即可，之后还可以继续补充添加拦截器，而其他的流程已经由SpringMVC帮助我们完成了。</p>
<h3 id="配置视图解析器和控制器"><a href="#配置视图解析器和控制器" class="headerlink" title="配置视图解析器和控制器"></a>配置视图解析器和控制器</h3><p>首先我们需要实现最基本的页面解析并返回，第一步就是配置视图解析器，这里我们使用Thymeleaf为我们提供的视图解析器，导入需要的依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.thymeleaf<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>thymeleaf-spring5<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.0.12.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name"><code class="language-hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.thymeleaf<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>thymeleaf-spring5<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.0.12.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>></span><br></code></pre></td></tr></table></figure>

<p>配置视图解析器非常简单，我们只需要将对应的<code>ViewResolver</code>注册为Bean即可，这里我们直接在配置类中编写：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@ComponentScan(&quot;com.example.controller&quot;)</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@EnableWebMvc</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WebConfiguration</span> </span>&#123;<br><br>  <span class="hljs-comment">//我们需要使用ThymeleafViewResolver作为视图解析器，并解析我们的HTML页面</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ThymeleafViewResolver <span class="hljs-title">thymeleafViewResolver</span><span class="hljs-params">(<span class="hljs-meta">@Autowired</span> SpringTemplateEngine springTemplateEngine)</span></span>&#123;<br>        ThymeleafViewResolver resolver = <span class="hljs-keyword">new</span> ThymeleafViewResolver();<br>        resolver.setOrder(<span class="hljs-number">1</span>);   <span class="hljs-comment">//可以存在多个视图解析器，并且可以为他们设定解析顺序</span><br>        resolver.setCharacterEncoding(<span class="hljs-string">&quot;UTF-8&quot;</span>);   <span class="hljs-comment">//编码格式是重中之重</span><br>        resolver.setTemplateEngine(springTemplateEngine);   <span class="hljs-comment">//和之前JavaWeb阶段一样，需要使用模板引擎进行解析，所以这里也需要设定一下模板引擎</span><br>        <span class="hljs-keyword">return</span> resolver;<br>    &#125;<br>  <br>  	<span class="hljs-comment">//配置模板解析器</span><br>  	<span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> SpringResourceTemplateResolver <span class="hljs-title">templateResolver</span><span class="hljs-params">()</span></span>&#123;<br>        SpringResourceTemplateResolver resolver = <span class="hljs-keyword">new</span> SpringResourceTemplateResolver();<br>        resolver.setSuffix(<span class="hljs-string">&quot;.html&quot;</span>);   <span class="hljs-comment">//需要解析的后缀名称</span><br>        resolver.setPrefix(<span class="hljs-string">&quot;/&quot;</span>);   <span class="hljs-comment">//需要解析的HTML页面文件存放的位置</span><br>        <span class="hljs-keyword">return</span> resolver;<br>    &#125;<br>  	<br>  	<span class="hljs-comment">//配置模板引擎Bean</span><br>  	<span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> SpringTemplateEngine <span class="hljs-title">springTemplateEngine</span><span class="hljs-params">(<span class="hljs-meta">@Autowired</span> ITemplateResolver resolver)</span></span>&#123;<br>        SpringTemplateEngine engine = <span class="hljs-keyword">new</span> SpringTemplateEngine();<br>        engine.setTemplateResolver(resolver);   <span class="hljs-comment">//模板解析器，默认即可</span><br>        <span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-meta">@ComponentScan(&quot;com.example.controller&quot;)</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@EnableWebMvc</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WebConfiguration</span> </span>&#123;<br><br>  <span class="hljs-comment">//我们需要使用ThymeleafViewResolver作为视图解析器，并解析我们的HTML页面</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ThymeleafViewResolver <span class="hljs-title">thymeleafViewResolver</span><span class="hljs-params">(<span class="hljs-meta">@Autowired</span> SpringTemplateEngine springTemplateEngine)</span></span>&#123;<br>        ThymeleafViewResolver resolver = <span class="hljs-keyword">new</span> ThymeleafViewResolver();<br>        resolver.setOrder(<span class="hljs-number">1</span>);   <span class="hljs-comment">//可以存在多个视图解析器，并且可以为他们设定解析顺序</span><br>        resolver.setCharacterEncoding(<span class="hljs-string">&quot;UTF-8&quot;</span>);   <span class="hljs-comment">//编码格式是重中之重</span><br>        resolver.setTemplateEngine(springTemplateEngine);   <span class="hljs-comment">//和之前JavaWeb阶段一样，需要使用模板引擎进行解析，所以这里也需要设定一下模板引擎</span><br>        <span class="hljs-keyword">return</span> resolver;<br>    &#125;<br>  <br>  	<span class="hljs-comment">//配置模板解析器</span><br>  	<span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> SpringResourceTemplateResolver <span class="hljs-title">templateResolver</span><span class="hljs-params">()</span></span>&#123;<br>        SpringResourceTemplateResolver resolver = <span class="hljs-keyword">new</span> SpringResourceTemplateResolver();<br>        resolver.setSuffix(<span class="hljs-string">&quot;.html&quot;</span>);   <span class="hljs-comment">//需要解析的后缀名称</span><br>        resolver.setPrefix(<span class="hljs-string">&quot;/&quot;</span>);   <span class="hljs-comment">//需要解析的HTML页面文件存放的位置</span><br>        <span class="hljs-keyword">return</span> resolver;<br>    &#125;<br>  	<br>  	<span class="hljs-comment">//配置模板引擎Bean</span><br>  	<span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> SpringTemplateEngine <span class="hljs-title">springTemplateEngine</span><span class="hljs-params">(<span class="hljs-meta">@Autowired</span> ITemplateResolver resolver)</span></span>&#123;<br>        SpringTemplateEngine engine = <span class="hljs-keyword">new</span> SpringTemplateEngine();<br>        engine.setTemplateResolver(resolver);   <span class="hljs-comment">//模板解析器，默认即可</span><br>        <span class="hljs-keyword">return</span> engine;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>别忘了在<code>Initializer</code>中添加此类作为配置：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Class[]&#123;MvcConfiguration.class&#125;;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>现在我们就完成了视图解析器的配置，我们接着来创建一个Controller，创建Controller也非常简单，只需在一个类上添加一个<code>@Controller</code>注解即可，它会被Spring扫描并自动注册为Controller类型的Bean，然后我们只需要在类中编写方法用于处理对应地址的请求即可：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Controller</span>   <span class="hljs-comment">//直接添加注解即可</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainController</span> </span>&#123;<br><br>    <span class="hljs-meta">@RequestMapping(&quot;/index&quot;)</span>   <span class="hljs-comment">//直接填写访问路径</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">&quot;index&quot;</span>);  <span class="hljs-comment">//返回ModelAndView对象，这里填入了视图的名称</span><br>      	<span class="hljs-comment"><code class="language-hljs java"><span class="hljs-meta">@Controller</span>   <span class="hljs-comment">//直接添加注解即可</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainController</span> </span>&#123;<br><br>    <span class="hljs-meta">@RequestMapping(&quot;/index&quot;)</span>   <span class="hljs-comment">//直接填写访问路径</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">&quot;index&quot;</span>);  <span class="hljs-comment">//返回ModelAndView对象，这里填入了视图的名称</span><br>      	<span class="hljs-comment">//返回后会经过视图解析器进行处理</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们会发现，打开浏览器之后就可以直接访问我们的HTML页面了。</p>
<p>而页面中的数据我们可以直接向Model进行提供：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    ModelAndView modelAndView = <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">&quot;index&quot;</span>);<br>    modelAndView.getModel().put(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;啊这&quot;</span>);<br>    <span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    ModelAndView modelAndView = <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">&quot;index&quot;</span>);<br>    modelAndView.getModel().put(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;啊这&quot;</span>);<br>    <span class="hljs-keyword">return</span> modelAndView;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这样Thymeleaf就能收到我们传递的数据进行解析：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre class=" language-hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;static/test.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    HelloWorld！<br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;name&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name"><code class="language-hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;static/test.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    HelloWorld！<br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;name&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>></span><br></code></pre></td></tr></table></figure>

<p>当然，如果仅仅是传递一个页面不需要任何的附加属性，我们可以直接返回View名称，SpringMVC会将其自动包装为ModelAndView对象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"index"</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>还可以单独添加一个Model作为形参进行设置，SpringMVC会自动帮助我们传递实例对象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">(Model model)</span></span>&#123;  <span class="hljs-comment">//这里不仅仅可以是Model，还可以是Map、ModelMap</span><br>    model.addAttribute(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;yyds&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">(Model model)</span></span>&#123;  <span class="hljs-comment">//这里不仅仅可以是Model，还可以是Map、ModelMap</span><br>    model.addAttribute(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;yyds&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"index"</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这么方便的写法，你就说你爱不爱吧，你爱不爱。</p>
<p>注意，一定要保证视图名称下面出现横线并且按住Ctrl可以跳转，配置才是正确的（最新版IDEA）</p>
<p>我们的页面中可能还会包含一些静态资源，比如js、css，因此这里我们还需要配置一下，让静态资源通过Tomcat提供的默认Servlet进行解析，我们需要让配置类实现一下<code>WebMvcConfigurer</code>接口，这样在Web应用程序启动时，会根据我们重写方法里面的内容进行进一步的配置：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configureDefaultServletHandling</span><span class="hljs-params">(DefaultServletHandlerConfigurer configurer)</span> </span>&#123;<br>    configurer.enable();   <span class="hljs-comment">//开启默认的Servlet</span><br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addResourceHandlers</span><span class="hljs-params">(ResourceHandlerRegistry registry)</span> </span>&#123;<br>    registry.addResourceHandler(<span class="hljs-string">&quot;/static/**&quot;</span>).addResourceLocations(<span class="hljs-string">&quot;/WEB-INF/static/&quot;</span>);   <br>  	<span class="hljs-comment"><code class="language-hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configureDefaultServletHandling</span><span class="hljs-params">(DefaultServletHandlerConfigurer configurer)</span> </span>&#123;<br>    configurer.enable();   <span class="hljs-comment">//开启默认的Servlet</span><br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addResourceHandlers</span><span class="hljs-params">(ResourceHandlerRegistry registry)</span> </span>&#123;<br>    registry.addResourceHandler(<span class="hljs-string">&quot;/static/**&quot;</span>).addResourceLocations(<span class="hljs-string">&quot;/WEB-INF/static/&quot;</span>);   <br>  	<span class="hljs-comment">//配置静态资源的访问路径</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们编写一下前端内容：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre class=" language-hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>      <span class="hljs-comment">&lt;!-- 引用静态资源，这里使用Thymeleaf的网址链接表达式，Thymeleaf会自动添加web应用程序的名称到链接前面 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">&quot;@&#123;/static/test.js&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    HelloWorld！<br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name"><code class="language-hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>      <span class="hljs-comment">&lt;!-- 引用静态资源，这里使用Thymeleaf的网址链接表达式，Thymeleaf会自动添加web应用程序的名称到链接前面 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">&quot;@&#123;/static/test.js&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    HelloWorld！<br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>></span><br></code></pre></td></tr></table></figure>

<p>创建<code>test.js</code>并编写如下内容：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre class=" language-hljs js"><span class="hljs-built_in">window</span>.alert(<span class="hljs-string"><code class="language-hljs js"><span class="hljs-built_in">window</span>.alert(<span class="hljs-string">"欢迎来到GayHub全球最大同性交友网站"</span>)<br></code></pre></td></tr></table></figure>

<p>最后访问页面，页面在加载时就会显示一个弹窗，这样我们就完成了最基本的页面配置。相比之前的方式，这样就简单很多了，直接避免了编写大量的Servlet来处理请求。</p>
<h3 id="RequestMapping详解"><a href="#RequestMapping详解" class="headerlink" title="@RequestMapping详解"></a>@RequestMapping详解</h3><p>前面我们已经了解了如何创建一个控制器来处理我们的请求，接着我们只需要在控制器添加一个方法用于处理对应的请求即可，之前我们需要完整地编写一个Servlet来实现，而现在我们只需要添加一个<code>@RequestMapping</code>即可实现，其实从它的名字我们也能得知，此注解就是将请求和处理请求的方法建立一个映射关系，当收到请求时就可以根据映射关系调用对应的请求处理方法，那么我们就来先聊聊<code>@RequestMapping</code>吧，注解定义如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Mapping</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> RequestMapping &#123;<br>    <span class="hljs-function">String <span class="hljs-title">name</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;&quot;</span>;<br><br>    <span class="hljs-meta">@AliasFor(&quot;path&quot;)</span><br>    String[] value() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>    <span class="hljs-meta">@AliasFor(&quot;value&quot;)</span><br>    String[] path() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>    RequestMethod[] method() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>    String[] params() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>    String[] headers() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>    String[] consumes() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>    String[] produces() <span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-meta">@Mapping</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> RequestMapping &#123;<br>    <span class="hljs-function">String <span class="hljs-title">name</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;&quot;</span>;<br><br>    <span class="hljs-meta">@AliasFor(&quot;path&quot;)</span><br>    String[] value() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>    <span class="hljs-meta">@AliasFor(&quot;value&quot;)</span><br>    String[] path() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>    RequestMethod[] method() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>    String[] params() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>    String[] headers() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>    String[] consumes() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>    String[] produces() <span class="hljs-keyword">default</span> &#123;&#125;;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>其中最关键的是path属性（等价于value），它决定了当前方法处理的请求路径，注意路径必须全局唯一，任何路径只能有一个方法进行处理，它是一个数组，也就是说此方法不仅仅可以只用于处理某一个请求路径，我们可以使用此方法处理多个请求路径：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(&#123;&quot;/index&quot;, &quot;/test&quot;&#125;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(&#123;&quot;/index&quot;, &quot;/test&quot;&#125;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>现在我们访问/index或是/test都会经过此方法进行处理。</p>
<p>我们也可以直接将<code>@RequestMapping</code>添加到类名上，表示为此类中的所有请求映射添加一个路径前缀，比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;/yyds&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainController</span> </span>&#123;<br><br>    <span class="hljs-meta">@RequestMapping(&#123;&quot;/index&quot;, &quot;/test&quot;&#125;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;/yyds&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainController</span> </span>&#123;<br><br>    <span class="hljs-meta">@RequestMapping(&#123;&quot;/index&quot;, &quot;/test&quot;&#125;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>那么现在我们需要访问<code>/yyds/index</code>或是<code>/yyds/test</code>才可以得到此页面。我们可以直接在IDEA下方的端点板块中查看当前Web应用程序定义的所有请求映射，并且可以通过IDEA为我们提供的内置Web客户端直接访问某个路径。</p>
<p>路径还支持使用通配符进行匹配：</p>
<ul>
<li>?：表示任意一个字符，比如<code>@RequestMapping(&quot;/index/x?&quot;)</code>可以匹配/index/xa、/index/xb等等。</li>
<li>*：表示任意0-n个字符，比如<code>@RequestMapping(&quot;/index/*&quot;)</code>可以匹配/index/lbwnb、/index/yyds等。</li>
<li>**：表示当前目录或基于当前目录的多级目录，比如<code>@RequestMapping(&quot;/index/**&quot;)</code>可以匹配/index、/index/xxx等。</li>
</ul>
<p>我们接着来看下一个method属性，顾名思义，它就是请求的方法类型，我们可以限定请求方式，比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, method = RequestMethod.POST)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, method = RequestMethod.POST)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>现在我们如果直接使用浏览器访问此页面，会显示405方法不支持，因为浏览器默认是直接使用GET方法获取页面，而我们这里指定为POST方法访问此地址，所以访问失败，我们现在再去端点中用POST方式去访问，成功得到页面。</p>
<p>我们也可以使用衍生注解直接设定为指定类型的请求映射：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@PostMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@PostMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这里使用了<code>@PostMapping</code>直接指定为POST请求类型的请求映射，同样的，还有<code>@GetMapping</code>可以直接指定为GET请求方式，这里就不一一列举了。</p>
<p>我们可以使用<code>params</code>属性来指定请求必须携带哪些请求参数，比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, params = &#123;&quot;username&quot;, &quot;password&quot;&#125;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, params = &#123;&quot;username&quot;, &quot;password&quot;&#125;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>比如这里我们要求请求中必须携带<code>username</code>和<code>password</code>属性，否则无法访问。它还支持表达式，比如我们可以这样编写：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, params = &#123;&quot;!username&quot;, &quot;password&quot;&#125;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, params = &#123;&quot;!username&quot;, &quot;password&quot;&#125;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在username之前添加一个感叹号表示请求的不允许携带此参数，否则无法访问，我们甚至可以直接设定一个固定值：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, params = &#123;&quot;username!=test&quot;, &quot;password=123&quot;&#125;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, params = &#123;&quot;username!=test&quot;, &quot;password=123&quot;&#125;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这样，请求参数username不允许为test，并且password必须为123，否则无法访问。</p>
<p><code>header</code>属性用法与<code>params</code>一致，但是它要求的是请求头中需要携带什么内容，比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, headers = &quot;!Connection&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, headers = &quot;!Connection&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>那么，如果请求头中携带了<code>Connection</code>属性，将无法访问。其他两个属性：</p>
<ul>
<li>consumes： 指定处理请求的提交内容类型（Content-Type），例如application/json, text/html;</li>
<li>produces:  指定返回的内容类型，仅当request请求头中的(Accept)类型中包含该指定类型才返回；</li>
</ul>
<h3 id="RequestParam和-RequestHeader详解"><a href="#RequestParam和-RequestHeader详解" class="headerlink" title="@RequestParam和@RequestHeader详解"></a>@RequestParam和@RequestHeader详解</h3><p>我们接着来看，如何获取到请求中的参数。</p>
<p>我们只需要为方法添加一个形式参数，并在形式参数前面添加<code>@RequestParam</code>注解即可：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;username&quot;)</span> String username)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;接受到请求参数：&quot;</span>+username);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;username&quot;)</span> String username)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;接受到请求参数：&quot;</span>+username);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们需要在<code>@RequestParam</code>中填写参数名称，参数的值会自动传递给形式参数，我们可以直接在方法中使用，注意，如果参数名称与形式参数名称相同，即使不添加<code>@RequestParam</code>也能获取到参数值。</p>
<p>一旦添加<code>@RequestParam</code>，那么此请求必须携带指定参数，我们也可以将require属性设定为false来将属性设定为非必须：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;username&quot;, required = false)</span> String username)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;接受到请求参数：&quot;</span>+username);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;username&quot;, required = false)</span> String username)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;接受到请求参数：&quot;</span>+username);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们还可以直接设定一个默认值，当请求参数缺失时，可以直接使用默认值：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;username&quot;, required = false, defaultValue = &quot;伞兵一号&quot;)</span> String username)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;接受到请求参数：&quot;</span>+username);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;username&quot;, required = false, defaultValue = &quot;伞兵一号&quot;)</span> String username)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;接受到请求参数：&quot;</span>+username);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>如果需要使用Servlet原本的一些类，比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(HttpServletRequest request)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;接受到请求参数：&quot;</span>+request.getParameterMap().keySet());<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(HttpServletRequest request)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;接受到请求参数：&quot;</span>+request.getParameterMap().keySet());<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>直接添加<code>HttpServletRequest</code>为形式参数即可，SpringMVC会自动传递该请求原本的<code>HttpServletRequest</code>对象，同理，我们也可以添加<code>HttpServletResponse</code>作为形式参数，甚至可以直接将HttpSession也作为参数传递：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(HttpSession session)</span></span>&#123;<br>    System.out.println(session.getAttribute(<span class="hljs-string">&quot;test&quot;</span>));<br>    session.setAttribute(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-string">&quot;鸡你太美&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(HttpSession session)</span></span>&#123;<br>    System.out.println(session.getAttribute(<span class="hljs-string">&quot;test&quot;</span>));<br>    session.setAttribute(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-string">&quot;鸡你太美&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们还可以直接将请求参数传递给一个实体类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title"><code class="language-hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>    String username;<br>    String password;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>注意必须携带set方法或是构造方法中包含所有参数，请求参数会自动根据类中的字段名称进行匹配：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(User user)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;获取到cookie值为：&quot;</span>+user);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(User user)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;获取到cookie值为：&quot;</span>+user);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>@RequestHeader</code>与<code>@RequestParam</code>用法一致，不过它是用于获取请求头参数的，这里就不再演示了。</p>
<h3 id="CookieValue和-SessionAttrbutie"><a href="#CookieValue和-SessionAttrbutie" class="headerlink" title="@CookieValue和@SessionAttrbutie"></a>@CookieValue和@SessionAttrbutie</h3><p>通过使用<code>@CookieValue</code>注解，我们也可以快速获取请求携带的Cookie信息：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(HttpServletResponse response,</span></span><br><span class="hljs-params"><span class="hljs-function">                          <span class="hljs-meta">@CookieValue(value = &quot;test&quot;, required = false)</span> String test)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;获取到cookie值为：&quot;</span>+test);<br>    response.addCookie(<span class="hljs-keyword">new</span> Cookie(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-string">&quot;lbwnb&quot;</span>));<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(HttpServletResponse response,</span></span><br><span class="hljs-params"><span class="hljs-function">                          <span class="hljs-meta">@CookieValue(value = &quot;test&quot;, required = false)</span> String test)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;获取到cookie值为：&quot;</span>+test);<br>    response.addCookie(<span class="hljs-keyword">new</span> Cookie(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-string">&quot;lbwnb&quot;</span>));<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>同样的，Session也能使用注解快速获取：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-meta">@SessionAttribute(value = &quot;test&quot;, required = false)</span> String test,</span></span><br><span class="hljs-params"><span class="hljs-function">                          HttpSession session)</span></span>&#123;<br>    session.setAttribute(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-string">&quot;xxxx&quot;</span>);<br>    System.out.println(test);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-meta">@SessionAttribute(value = &quot;test&quot;, required = false)</span> String test,</span></span><br><span class="hljs-params"><span class="hljs-function">                          HttpSession session)</span></span>&#123;<br>    session.setAttribute(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-string">&quot;xxxx&quot;</span>);<br>    System.out.println(test);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以发现，通过使用SpringMVC框架，整个Web应用程序的开发变得非常简单，大部分功能只需要一个注解就可以搞定了，正是得益于Spring框架，SpringMVC才能大显身手。</p>
<h3 id="重定向和请求转发"><a href="#重定向和请求转发" class="headerlink" title="重定向和请求转发"></a>重定向和请求转发</h3><p>重定向和请求转发也非常简单，我们只需要在视图名称前面添加一个前缀即可，比如重定向：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;redirect:home&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">@RequestMapping(&quot;/home&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">home</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;redirect:home&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">@RequestMapping(&quot;/home&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">home</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"home"</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>通过添加<code>redirect:</code>前缀，就可以很方便地实现重定向，那么请求转发呢，其实也是一样的，使用<code>forward:</code>前缀表示转发给其他请求映射：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;forward:home&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">@RequestMapping(&quot;/home&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">home</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;forward:home&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">@RequestMapping(&quot;/home&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">home</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"home"</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>使用SpringMVC，只需要一个前缀就可以实现重定向和请求转发，非常方便。</p>
<h3 id="Bean的Web作用域"><a href="#Bean的Web作用域" class="headerlink" title="Bean的Web作用域"></a>Bean的Web作用域</h3><p>在学习Spring时我们讲解了Bean的作用域，包括<code>singleton</code>和<code>prototype</code>，Bean分别会以单例和多例模式进行创建，而在SpringMVC中，它的作用域被继续细分：</p>
<ul>
<li>request：对于每次HTTP请求，使用request作用域定义的Bean都将产生一个新实例，请求结束后Bean也消失。</li>
<li>session：对于每一个会话，使用session作用域定义的Bean都将产生一个新实例，会话过期后Bean也消失。</li>
<li>global session：不常用，不做讲解。</li>
</ul>
<p>这里我们创建一个测试类来试试看：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title"><code class="language-hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestBean</span> </span>&#123;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>接着将其注册为Bean，注意这里需要添加<code>@RequestScope</code>或是<code>@SessionScope</code>表示此Bean的Web作用域：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-meta">@RequestScope</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> TestBean <span class="hljs-title">testBean</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-meta">@RequestScope</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> TestBean <span class="hljs-title">testBean</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TestBean();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>接着我们将其自动注入到Controller中：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainController</span> </span>&#123;<br><br>    <span class="hljs-meta">@Resource</span><br>    TestBean bean;<br><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(bean);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainController</span> </span>&#123;<br><br>    <span class="hljs-meta">@Resource</span><br>    TestBean bean;<br><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(bean);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">"index"</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们发现，每次发起得到的Bean实例都不同，接着我们将其作用域修改为<code>@SessionScope</code>，这样作用域就上升到Session，只要清理浏览器的Cookie，那么都会被认为是同一个会话，只要是同一个会话，那么Bean实例始终不变。</p>
<p>实际上，它也是通过代理实现的，我们调用Bean中的方法会被转发到真正的Bean对象去执行。</p>
<hr>
<h2 id="RestFul风格"><a href="#RestFul风格" class="headerlink" title="RestFul风格"></a>RestFul风格</h2><p>中文释义为<strong>“表现层状态转换”</strong>（名字挺高大上的），它不是一种标准，而是一种设计风格。它的主要作用是充分并正确利用HTTP协议的特性，规范资源获取的URI路径。通俗的讲，RESTful风格的设计允许将参数通过URL拼接传到服务端，目的是让URL看起来更简洁实用，并且我们可以充分使用多种HTTP请求方式（POST/GET/PUT/DELETE），来执行相同请求地址的不同类型操作。</p>
<p>因此，这种风格的连接，我们就可以直接从请求路径中读取参数，比如：</p>
<p><code>http://localhost:8080/mvc/index/123456</code></p>
<p>我们可以直接将index的下一级路径作为请求参数进行处理，也就是说现在的请求参数包含在了请求路径中：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/index/&#123;str&#125;&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> String str)</span> </span>&#123;<br>    System.out.println(str);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/index/&#123;str&#125;&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> String str)</span> </span>&#123;<br>    System.out.println(str);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"index"</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>注意请求路径我们可以手动添加类似占位符一样的信息，这样占位符位置的所有内容都会被作为请求参数，而方法的形参列表中必须包括一个与占位符同名的并且添加了<code>@PathVariable</code>注解的参数，或是由<code>@PathVariable</code>注解指定为占位符名称：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/index/&#123;str&#125;&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;str&quot;)</span> String text)</span></span>&#123;<br>    System.out.println(text);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/index/&#123;str&#125;&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;str&quot;)</span> String text)</span></span>&#123;<br>    System.out.println(text);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"index"</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>如果没有配置正确，方法名称上会出现黄线。</p>
<p>我们可以按照不同功能进行划分：</p>
<ul>
<li>POST <a target="_blank" rel="noopener" href="http://localhost:8080/mvc/index">http://localhost:8080/mvc/index</a>  -  添加用户信息，携带表单数据</li>
<li>GET <a target="_blank" rel="noopener" href="http://localhost:8080/mvc/index/%7Bid%7D">http://localhost:8080/mvc/index/{id}</a>  -  获取用户信息，id直接放在请求路径中</li>
<li>PUT <a target="_blank" rel="noopener" href="http://localhost:8080/mvc/index">http://localhost:8080/mvc/index</a>  -  修改用户信息，携带表单数据</li>
<li>DELETE <a target="_blank" rel="noopener" href="http://localhost:8080/mvc/index/%7Bid%7D">http://localhost:8080/mvc/index/{id}</a>  -  删除用户信息，id直接放在请求路径中</li>
</ul>
<p>我们分别编写四个请求映射：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainController</span> </span>&#123;<br><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/index/&#123;id&#125;&quot;, method = RequestMethod.GET)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> String text)</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;获取用户：&quot;</span>+text);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;index&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, method = RequestMethod.POST)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">post</span><span class="hljs-params">(String username)</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;添加用户：&quot;</span>+username);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;index&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/index/&#123;id&#125;&quot;, method = RequestMethod.DELETE)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">delete</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> String text)</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;删除用户：&quot;</span>+text);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;index&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, method = RequestMethod.PUT)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">put</span><span class="hljs-params">(String username)</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;修改用户：&quot;</span>+username);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainController</span> </span>&#123;<br><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/index/&#123;id&#125;&quot;, method = RequestMethod.GET)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> String text)</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;获取用户：&quot;</span>+text);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;index&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, method = RequestMethod.POST)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">post</span><span class="hljs-params">(String username)</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;添加用户：&quot;</span>+username);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;index&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/index/&#123;id&#125;&quot;, method = RequestMethod.DELETE)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">delete</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;id&quot;)</span> String text)</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;删除用户：&quot;</span>+text);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;index&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, method = RequestMethod.PUT)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">put</span><span class="hljs-params">(String username)</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;修改用户：&quot;</span>+username);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"index"</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这只是一种设计风格而已，各位小伙伴了解即可。</p>
<hr>
<h2 id="Interceptor拦截器"><a href="#Interceptor拦截器" class="headerlink" title="Interceptor拦截器"></a>Interceptor拦截器</h2><p>拦截器是整个SpringMVC的一个重要内容，拦截器与过滤器类似，都是用于拦截一些非法请求，但是我们之前讲解的过滤器是作用于Servlet之前，只有经过层层的拦截器才可以成功到达Servlet，而拦截器并不是在Servlet之前，它在Servlet与RequestMapping之间，相当于DispatcherServlet在将请求交给对应Controller中的方法之前进行拦截处理，它只会拦截所有Controller中定义的请求映射对应的请求（不会拦截静态资源），这里一定要区分两者的不同。</p>
<p><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F4685968-ca4e9021f653c954.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240&refer=http%3A%2F%2Fupload-images.jianshu.io&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1642340637&t=70d3dd6b52ae01ac76c04d99e6bd95ed" srcset="/img/loading.gif" lazyload alt="点击查看源网页"></p>
<h3 id="创建拦截器"><a href="#创建拦截器" class="headerlink" title="创建拦截器"></a>创建拦截器</h3><p>创建一个拦截器我们需要实现一个<code>HandlerInterceptor</code>接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HandlerInterceptor</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;我是处理之前！&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;   <span class="hljs-comment">//只有返回true才会继续，否则直接结束</span><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;我是处理之后！&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HandlerInterceptor</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;我是处理之前！&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;   <span class="hljs-comment">//只有返回true才会继续，否则直接结束</span><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;我是处理之后！&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">"我是完成之后！"</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>接着我们需要在配置类中进行注册：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> </span>&#123;<br>    registry.addInterceptor(<span class="hljs-keyword">new</span> MainInterceptor())<br>      .addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>)    <span class="hljs-comment">//添加拦截器的匹配路径，只要匹配一律拦截</span><br>      .excludePathPatterns(<span class="hljs-string">&quot;/home&quot;</span>);   <span class="hljs-comment"><code class="language-hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> </span>&#123;<br>    registry.addInterceptor(<span class="hljs-keyword">new</span> MainInterceptor())<br>      .addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>)    <span class="hljs-comment">//添加拦截器的匹配路径，只要匹配一律拦截</span><br>      .excludePathPatterns(<span class="hljs-string">&quot;/home&quot;</span>);   <span class="hljs-comment">//拦截器不进行拦截的路径</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>现在我们在浏览器中访问index页面，拦截器已经生效。</p>
<p>得到整理拦截器的执行顺序：</p>
<blockquote>
<p>我是处理之前！</p>
<p>我是处理！</p>
<p>我是处理之后！</p>
<p>我是完成之后！</p>
</blockquote>
<p>也就是说，处理前和处理后，包含了真正的请求映射的处理，在整个流程结束后还执行了一次<code>afterCompletion</code>方法，其实整个过程与我们之前所认识的Filter类似，不过在处理前，我们只需要返回true或是false表示是否被拦截即可，而不是再去使用FilterChain进行向下传递。</p>
<p>那么我们就来看看，如果处理前返回false，会怎么样：</p>
<blockquote>
<p>我是处理之前！</p>
</blockquote>
<p>通过结果发现一旦返回false，之后的所有流程全部取消，那么如果是在处理中发生异常了呢？</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;我是处理！&quot;</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">true</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;我是处理！&quot;</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">true</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"index"</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>结果为：</p>
<blockquote>
<p>我是处理之前！<br>我是处理！<br>我是完成之后！</p>
</blockquote>
<p>我们发现如果处理过程中抛出异常，那么久不会执行处理后<code>postHandle</code>方法，但是会执行<code>afterCompletion</code>方法，我们可以在此方法中获取到抛出的异常。</p>
<h3 id="多级拦截器"><a href="#多级拦截器" class="headerlink" title="多级拦截器"></a>多级拦截器</h3><p>前面介绍了仅仅只有一个拦截器的情况，我们接着来看如果存在多个拦截器会如何执行，我们以同样的方式创建二号拦截器：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SubInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HandlerInterceptor</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;二号拦截器：我是处理之前！&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;二号拦截器：我是处理之后！&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SubInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HandlerInterceptor</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;二号拦截器：我是处理之前！&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;二号拦截器：我是处理之后！&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        System.out.println(<span class="hljs-string">"二号拦截器：我是完成之后！"</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>注册二号拦截器：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> </span>&#123;<br>  	<span class="hljs-comment">//一号拦截器</span><br>    registry.addInterceptor(<span class="hljs-keyword">new</span> MainInterceptor()).addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>).excludePathPatterns(<span class="hljs-string">&quot;/home&quot;</span>);<br>  	<span class="hljs-comment">//二号拦截器</span><br>    registry.addInterceptor(<span class="hljs-keyword">new</span> SubInterceptor()).addPathPatterns(<span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> </span>&#123;<br>  	<span class="hljs-comment">//一号拦截器</span><br>    registry.addInterceptor(<span class="hljs-keyword">new</span> MainInterceptor()).addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>).excludePathPatterns(<span class="hljs-string">&quot;/home&quot;</span>);<br>  	<span class="hljs-comment">//二号拦截器</span><br>    registry.addInterceptor(<span class="hljs-keyword">new</span> SubInterceptor()).addPathPatterns(<span class="hljs-string">"/**"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>注意拦截顺序就是注册的顺序，因此拦截器会根据注册顺序依次执行，我们可以打开浏览器运行一次：</p>
<blockquote>
<p>一号拦截器：我是处理之前！<br>二号拦截器：我是处理之前！<br>我是处理！<br>二号拦截器：我是处理之后！<br>一号拦截器：我是处理之后！<br>二号拦截器：我是完成之后！<br>一号拦截器：我是完成之后！</p>
</blockquote>
<p>和多级Filter相同，在处理之前，是按照顺序从前向后进行拦截的，但是处理完成之后，就按照倒序执行处理后方法，而完成后是在所有的<code>postHandle</code>执行之后再同样的以倒序方式执行。</p>
<p>那么如果这时一号拦截器在处理前就返回了false呢？</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;一号拦截器：我是处理之前！&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;一号拦截器：我是处理之前！&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>得到结果如下：</p>
<blockquote>
<p>一号拦截器：我是处理之前！</p>
</blockquote>
<p>我们发现，与单个拦截器的情况一样，一旦拦截器返回false，那么之后无论有无拦截器，都不再继续。</p>
<h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><p>当我们的请求映射方法中出现异常时，会直接展示在前端页面，这是因为SpringMVC为我们提供了默认的异常处理页面，当出现异常时，我们的请求会被直接转交给专门用于异常处理的控制器进行处理。</p>
<p>我们可以自定义一个异常处理控制器，一旦出现指定异常，就会转接到此控制器执行：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@ControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ErrorController</span> </span>&#123;<br><br>    <span class="hljs-meta">@ExceptionHandler(Exception.class)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">error</span><span class="hljs-params">(Exception e, Model model)</span></span>&#123;  <span class="hljs-comment">//可以直接添加形参来获取异常</span><br>        e.printStackTrace();<br>        model.addAttribute(<span class="hljs-string">&quot;e&quot;</span>, e);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@ControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ErrorController</span> </span>&#123;<br><br>    <span class="hljs-meta">@ExceptionHandler(Exception.class)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">error</span><span class="hljs-params">(Exception e, Model model)</span></span>&#123;  <span class="hljs-comment">//可以直接添加形参来获取异常</span><br>        e.printStackTrace();<br>        model.addAttribute(<span class="hljs-string">&quot;e&quot;</span>, e);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"500"</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>接着我们编写一个专门显示异常的页面：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre class=" language-hljs java">&lt;!DOCTYPE html&gt;<br>&lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;title&gt;Title&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>  <span class="hljs-number">500</span> - 服务器出现了一个内部错误QAQ<br>  &lt;div th:text=<span class="hljs-string"><code class="language-hljs java">&lt;!DOCTYPE html&gt;<br>&lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;title&gt;Title&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>  <span class="hljs-number">500</span> - 服务器出现了一个内部错误QAQ<br>  &lt;div th:text=<span class="hljs-string">"$&#123;e&#125;"</span>></div><br></body><br></html><br></code></pre></td></tr></table></figure>

<p>接着修改：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;我是处理！&quot;</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">true</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;您的氪金力度不足，无法访问！&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;我是处理！&quot;</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">true</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;您的氪金力度不足，无法访问！&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"index"</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>访问后，我们发现控制台会输出异常信息，同时页面也是我们自定义的一个页面。</p>
<h2 id="JSON数据格式与AJAX请求"><a href="#JSON数据格式与AJAX请求" class="headerlink" title="JSON数据格式与AJAX请求"></a>JSON数据格式与AJAX请求</h2><p>JSON (JavaScript Object Notation, JS 对象简谱) 是一种轻量级的数据交换格式。</p>
<p>我们现在推崇的是前后端分离的开发模式，而不是所有的内容全部交给后端渲染再发送给浏览器，也就是说，整个Web页面的内容在一开始就编写完成了，而其中的数据由前端执行JS代码来向服务器动态获取，再到前端进行渲染（填充），这样可以大幅度减少后端的压力，并且后端只需要传输关键数据即可（在即将到来的SpringBoot阶段，我们将完全采用前后端分离的开发模式）</p>
<h3 id="JSON数据格式"><a href="#JSON数据格式" class="headerlink" title="JSON数据格式"></a>JSON数据格式</h3><p>既然要实现前后端分离，那么我们就必须约定一种更加高效的数据传输模式，来向前端页面传输后端提供的数据。因此JSON横空出世，它非常容易理解，并且与前端的兼容性极好，因此现在比较主流的数据传输方式则是通过JSON格式承载的。</p>
<p>一个JSON格式的数据长这样，以学生对象为例：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre class=" language-hljs json">&#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;杰哥&quot;</span>, <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number"><code class="language-hljs json">&#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;杰哥&quot;</span>, <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number">18</span>&#125;<br></code></pre></td></tr></table></figure>

<p>多个学生可以以数组的形式表示：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre class=" language-hljs json">[&#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;杰哥&quot;</span>, <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number">18</span>&#125;, &#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;阿伟&quot;</span>, <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number"><code class="language-hljs json">[&#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;杰哥&quot;</span>, <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number">18</span>&#125;, &#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;阿伟&quot;</span>, <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number">18</span>&#125;]<br></code></pre></td></tr></table></figure>

<p>嵌套关系可以表示为：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre class=" language-hljs json">&#123;<span class="hljs-attr">&quot;studentList&quot;</span>: [&#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;杰哥&quot;</span>, <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number">18</span>&#125;, &#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;阿伟&quot;</span>, <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number">18</span>&#125;], <span class="hljs-attr">&quot;count&quot;</span>: <span class="hljs-number"><code class="language-hljs json">&#123;<span class="hljs-attr">&quot;studentList&quot;</span>: [&#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;杰哥&quot;</span>, <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number">18</span>&#125;, &#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;阿伟&quot;</span>, <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number">18</span>&#125;], <span class="hljs-attr">&quot;count&quot;</span>: <span class="hljs-number">2</span>&#125;<br></code></pre></td></tr></table></figure>

<p>它直接包括了属性的名称和属性的值，与JavaScript的对象极为相似，它到达前端后，可以直接转换为对象，以对象的形式进行操作和内容的读取，相当于以字符串形式表示了一个JS对象，我们可以直接在控制台窗口中测试：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre class=" language-hljs js"><span class="hljs-keyword">let</span> obj = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-string">&#x27;&#123;&quot;studentList&quot;: [&#123;&quot;name&quot;: &quot;杰哥&quot;, &quot;age&quot;: 18&#125;, &#123;&quot;name&quot;: &quot;阿伟&quot;, &quot;age&quot;: 18&#125;], &quot;count&quot;: 2&#125;&#x27;</span>)<br><span class="hljs-comment">//将JSON格式字符串转换为JS对象</span><br>obj.studentList[<span class="hljs-number">0</span>].name   <span class="hljs-comment"><code class="language-hljs js"><span class="hljs-keyword">let</span> obj = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-string">&#x27;&#123;&quot;studentList&quot;: [&#123;&quot;name&quot;: &quot;杰哥&quot;, &quot;age&quot;: 18&#125;, &#123;&quot;name&quot;: &quot;阿伟&quot;, &quot;age&quot;: 18&#125;], &quot;count&quot;: 2&#125;&#x27;</span>)<br><span class="hljs-comment">//将JSON格式字符串转换为JS对象</span><br>obj.studentList[<span class="hljs-number">0</span>].name   <span class="hljs-comment">//直接访问第一个学生的名称</span><br></code></pre></td></tr></table></figure>

<p>我们也可以将JS对象转换为JSON字符串：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre class=" language-hljs js"><span class="hljs-built_in"><code class="language-hljs js"><span class="hljs-built_in">JSON</span>.stringify(obj)<br></code></pre></td></tr></table></figure>

<p>我们后端就可以以JSON字符串的形式向前端返回数据，这样前端在拿到数据之后，就可以快速获取，非常方便。</p>
<p>那么后端如何快速创建一个JSON格式的数据呢？我们首先需要导入以下依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.78<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name"><code class="language-hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.78<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>></span><br></code></pre></td></tr></table></figure>

<p>JSON解析框架有很多种，比较常用的是Jackson和FastJSON，这里我们使用阿里巴巴的FastJSON进行解析。</p>
<p>首先要介绍的是JSONObject，它和Map的使用方法一样（实现了Map接口），比如我们向其中存放几个数据：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    JSONObject object = <span class="hljs-keyword">new</span> JSONObject();<br>    object.put(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;杰哥&quot;</span>);<br>    object.put(<span class="hljs-string">&quot;age&quot;</span>, <span class="hljs-number">18</span>);<br>    System.out.println(object.toJSONString());   <span class="hljs-comment">//以JSON格式输出JSONObject字符串</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    JSONObject object = <span class="hljs-keyword">new</span> JSONObject();<br>    object.put(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;杰哥&quot;</span>);<br>    object.put(<span class="hljs-string">&quot;age&quot;</span>, <span class="hljs-number">18</span>);<br>    System.out.println(object.toJSONString());   <span class="hljs-comment">//以JSON格式输出JSONObject字符串</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"index"</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>最后我们得到的结果为：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre class=" language-hljs json">&#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;杰哥&quot;</span>, <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number"><code class="language-hljs json">&#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;杰哥&quot;</span>, <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number">18</span>&#125;<br></code></pre></td></tr></table></figure>

<p>实际上JSONObject就是对JSON数据的一种对象表示。同样的还有JSONArray，它表示一个数组，用法和List一样，数组中可以嵌套其他的JSONObject或是JSONArray：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    JSONObject object = <span class="hljs-keyword">new</span> JSONObject();<br>    object.put(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;杰哥&quot;</span>);<br>    object.put(<span class="hljs-string">&quot;age&quot;</span>, <span class="hljs-number">18</span>);<br>    JSONArray array = <span class="hljs-keyword">new</span> JSONArray();<br>    array.add(object);<br>    System.out.println(array.toJSONString());<br>    <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>&#123;<br>    JSONObject object = <span class="hljs-keyword">new</span> JSONObject();<br>    object.put(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;杰哥&quot;</span>);<br>    object.put(<span class="hljs-string">&quot;age&quot;</span>, <span class="hljs-number">18</span>);<br>    JSONArray array = <span class="hljs-keyword">new</span> JSONArray();<br>    array.add(object);<br>    System.out.println(array.toJSONString());<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"index"</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>得到的结果为：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre class=" language-hljs json">[&#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;杰哥&quot;</span>, <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number"><code class="language-hljs json">[&#123;<span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;杰哥&quot;</span>, <span class="hljs-attr">&quot;age&quot;</span>: <span class="hljs-number">18</span>&#125;]<br></code></pre></td></tr></table></figure>

<p>当出现循环引用时，会按照以下语法来解析：<img src="https://img2018.cnblogs.com/blog/1758707/201908/1758707-20190814212141691-1998020800.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>我们可以也直接创建一个实体类，将实体类转换为JSON格式的数据：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, produces = &quot;application/json&quot;)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">data</span><span class="hljs-params">()</span></span>&#123;<br>    Student student = <span class="hljs-keyword">new</span> Student();<br>    student.setName(<span class="hljs-string">&quot;杰哥&quot;</span>);<br>    student.setAge(<span class="hljs-number">18</span>);<br>    <span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/index&quot;, produces = &quot;application/json&quot;)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">data</span><span class="hljs-params">()</span></span>&#123;<br>    Student student = <span class="hljs-keyword">new</span> Student();<br>    student.setName(<span class="hljs-string">&quot;杰哥&quot;</span>);<br>    student.setAge(<span class="hljs-number">18</span>);<br>    <span class="hljs-keyword">return</span> JSON.toJSONString(student);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这里我们修改了<code>produces</code>的值，将返回的内容类型设定为<code>application/json</code>，表示服务器端返回了一个JSON格式的数据（当然不设置也行，也能展示，这样是为了规范）然后我们在方法上添加一个<code>@ResponseBody</code>表示方法返回（也可以在类上添加<code>@RestController</code>表示此Controller默认返回的是字符串数据）的结果不是视图名称而是直接需要返回一个字符串作为页面数据，这样，返回给浏览器的就是我们直接返回的字符串内容。</p>
<p>接着我们使用JSON工具类将其转换为JSON格式的字符串，打开浏览器，得到JSON格式数据。</p>
<p>SpringMVC非常智能，我们可以直接返回一个对象类型，它会被自动转换为JSON字符串格式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/data&quot;, produces = &quot;application/json&quot;)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Student <span class="hljs-title">data</span><span class="hljs-params">()</span></span>&#123;<br>    Student student = <span class="hljs-keyword">new</span> Student();<br>    student.setName(<span class="hljs-string">&quot;杰哥&quot;</span>);<br>    student.setAge(<span class="hljs-number">18</span>);<br>    <span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/data&quot;, produces = &quot;application/json&quot;)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Student <span class="hljs-title">data</span><span class="hljs-params">()</span></span>&#123;<br>    Student student = <span class="hljs-keyword">new</span> Student();<br>    student.setName(<span class="hljs-string">&quot;杰哥&quot;</span>);<br>    student.setAge(<span class="hljs-number">18</span>);<br>    <span class="hljs-keyword">return</span> student;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>注意需要在配置类中添加一下FastJSON转换器（默认只支持JackSon）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configureMessageConverters</span><span class="hljs-params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> </span>&#123;<br>    converters.add(<span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configureMessageConverters</span><span class="hljs-params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> </span>&#123;<br>    converters.add(<span class="hljs-keyword">new</span> FastJsonHttpMessageConverter());<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="AJAX请求"><a href="#AJAX请求" class="headerlink" title="AJAX请求"></a>AJAX请求</h3><p>前面我们讲解了如何向浏览器发送一个JSON格式的数据，那么我们现在来看看如何向服务器请求数据。</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2013/09/ajax-yl.png" srcset="/img/loading.gif" lazyload alt="AJAX"></p>
<p>Ajax即<strong>A</strong>synchronous <strong>J</strong>avascript <strong>A</strong>nd <strong>X</strong>ML（异步JavaScript和XML），它的目标就是实现页面中的数据动态更新，而不是直接刷新整个页面，它是一个概念。</p>
<p>它在JQuery框架中有实现，因此我们直接导入JQuery（JQuery极大地简化了JS的开发，封装了很多内容，感兴趣的可以了解一下）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre class=" language-hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://code.jquery.com/jquery-3.1.1.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name"><code class="language-hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://code.jquery.com/jquery-3.1.1.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>></span><br></code></pre></td></tr></table></figure>

<p>接着我们就可以直接使用了，首先修改一下前端页面：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre class=" language-hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://code.jquery.com/jquery-3.1.1.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">&quot;@&#123;/static/test.js&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    你好，<br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    您的年龄是：<br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;age&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;updateData()&quot;</span>&gt;</span>点我更新页面数据<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name"><code class="language-hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://code.jquery.com/jquery-3.1.1.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">&quot;@&#123;/static/test.js&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    你好，<br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    您的年龄是：<br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;age&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;updateData()&quot;</span>&gt;</span>点我更新页面数据<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>></span><br></code></pre></td></tr></table></figure>

<p>现在我们希望用户名称和年龄需要在我们点击按钮之后才会更新，我们接着来编写一下JS：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre class=" language-hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateData</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-comment">//美元符.的方式来使用Ajax请求，这里使用的是get方式，第一个参数为请求的地址（注意需要带上Web应用程序名称），第二个参数为成功获取到数据的方法，data就是返回的数据内容</span><br>  	$.get(<span class="hljs-string">&quot;/mvc/data&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>&#123;   <span class="hljs-comment">//获取成功执行的方法</span><br>        <span class="hljs-built_in">window</span>.alert(<span class="hljs-string">&#x27;接受到异步请求数据：&#x27;</span>+<span class="hljs-built_in">JSON</span>.stringify(data))  <span class="hljs-comment">//弹窗展示数据</span><br>        $(<span class="hljs-string">&quot;#username&quot;</span>).text(data.name)   <span class="hljs-comment">//这里使用了JQuery提供的选择器，直接选择id为username的元素，更新数据</span><br>        $(<span class="hljs-string"><code class="language-hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateData</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-comment">//美元符.的方式来使用Ajax请求，这里使用的是get方式，第一个参数为请求的地址（注意需要带上Web应用程序名称），第二个参数为成功获取到数据的方法，data就是返回的数据内容</span><br>  	$.get(<span class="hljs-string">&quot;/mvc/data&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>&#123;   <span class="hljs-comment">//获取成功执行的方法</span><br>        <span class="hljs-built_in">window</span>.alert(<span class="hljs-string">&#x27;接受到异步请求数据：&#x27;</span>+<span class="hljs-built_in">JSON</span>.stringify(data))  <span class="hljs-comment">//弹窗展示数据</span><br>        $(<span class="hljs-string">&quot;#username&quot;</span>).text(data.name)   <span class="hljs-comment">//这里使用了JQuery提供的选择器，直接选择id为username的元素，更新数据</span><br>        $(<span class="hljs-string">"#age"</span>).text(data.age)<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>使用JQuery非常方便，我们直接通过JQuery的选择器就可以快速获取页面中的元素，注意这里获取的元素是被JQuery封装过的元素，需要使用JQuery提供的方法来进行操作。</p>
<p>这样，我们就实现了从服务端获取数据并更新到页面中（实际上之前，我们在JavaWeb阶段使用XHR请求也演示过，不过当时是纯粹的数据）</p>
<p>那么我们接着来看，如何向服务端发送一个JS对象数据并进行解析：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre class=" language-hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">submitData</span>(<span class="hljs-params"></span>) </span>&#123;<br>    $.post(<span class="hljs-string">&quot;/mvc/submit&quot;</span>, &#123;   <span class="hljs-comment">//这里使用POST方法发送请求</span><br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;测试&quot;</span>,     <span class="hljs-comment">//第二个参数是要传递的对象，会以表单数据的方式发送</span><br>      	<span class="hljs-attr">age</span>: <span class="hljs-number">18</span>   <br>    &#125;, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>&#123;<br>        <span class="hljs-built_in">window</span>.alert(<span class="hljs-built_in">JSON</span>.stringify(data))   <span class="hljs-comment"><code class="language-hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">submitData</span>(<span class="hljs-params"></span>) </span>&#123;<br>    $.post(<span class="hljs-string">&quot;/mvc/submit&quot;</span>, &#123;   <span class="hljs-comment">//这里使用POST方法发送请求</span><br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;测试&quot;</span>,     <span class="hljs-comment">//第二个参数是要传递的对象，会以表单数据的方式发送</span><br>      	<span class="hljs-attr">age</span>: <span class="hljs-number">18</span>   <br>    &#125;, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>&#123;<br>        <span class="hljs-built_in">window</span>.alert(<span class="hljs-built_in">JSON</span>.stringify(data))   <span class="hljs-comment">//发送成功执行的方法</span><br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>服务器端只需要在请求参数位置添加一个对象接收即可（和前面是一样的，因为这里也是提交的表单数据）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/submit&quot;)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">submit</span><span class="hljs-params">(Student student)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;接收到前端数据：&quot;</span>+student);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/submit&quot;)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">submit</span><span class="hljs-params">(Student student)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;接收到前端数据：&quot;</span>+student);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"&#123;\"success\": true&#125;"</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们也可以将js对象转换为JSON字符串的形式进行传输，这里需要使用ajax方法来处理：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre class=" language-hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">submitData</span>(<span class="hljs-params"></span>) </span>&#123;<br>    $.ajax(&#123;   <span class="hljs-comment">//最基本的请求方式，需要自己设定一些参数</span><br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,   <span class="hljs-comment">//设定请求方法</span><br>        <span class="hljs-attr">url</span>: <span class="hljs-string">&quot;/mvc/submit&quot;</span>,   <span class="hljs-comment">//请求地址</span><br>        <span class="hljs-attr">data</span>: <span class="hljs-built_in">JSON</span>.stringify(&#123;<span class="hljs-attr">name</span>: <span class="hljs-string">&quot;测试&quot;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>&#125;),  <span class="hljs-comment">//转换为JSON字符串进行发送</span><br>        <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>&#123;<br>            <span class="hljs-built_in">window</span>.alert(<span class="hljs-built_in">JSON</span>.stringify(data))<br>        &#125;,<br>        <span class="hljs-attr">contentType</span>: <span class="hljs-string">&quot;application/json&quot;</span>  <span class="hljs-comment"><code class="language-hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">submitData</span>(<span class="hljs-params"></span>) </span>&#123;<br>    $.ajax(&#123;   <span class="hljs-comment">//最基本的请求方式，需要自己设定一些参数</span><br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,   <span class="hljs-comment">//设定请求方法</span><br>        <span class="hljs-attr">url</span>: <span class="hljs-string">&quot;/mvc/submit&quot;</span>,   <span class="hljs-comment">//请求地址</span><br>        <span class="hljs-attr">data</span>: <span class="hljs-built_in">JSON</span>.stringify(&#123;<span class="hljs-attr">name</span>: <span class="hljs-string">&quot;测试&quot;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>&#125;),  <span class="hljs-comment">//转换为JSON字符串进行发送</span><br>        <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>&#123;<br>            <span class="hljs-built_in">window</span>.alert(<span class="hljs-built_in">JSON</span>.stringify(data))<br>        &#125;,<br>        <span class="hljs-attr">contentType</span>: <span class="hljs-string">&quot;application/json&quot;</span>  <span class="hljs-comment">//请求头Content-Type一定要设定为JSON格式</span><br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>如果我们需要读取前端发送给我们的JSON格式数据，那么这个时候就需要添加<code>@RequestBody</code>注解：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/submit&quot;)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">submit</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> JSONObject object)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;接收到前端数据：&quot;</span>+object);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(&quot;/submit&quot;)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">submit</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> JSONObject object)</span></span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;接收到前端数据：&quot;</span>+object);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"&#123;\"success\": true&#125;"</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这样，我们就实现了前后端使用JSON字符串进行通信。</p>
<h2 id="实现文件上传和下载"><a href="#实现文件上传和下载" class="headerlink" title="实现文件上传和下载"></a>实现文件上传和下载</h2><p>利用SpringMVC，我们可以很轻松地实现文件上传和下载，同样的，我们只需要配置一个Resolver：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Bean(&quot;multipartResolver&quot;)</span>   <span class="hljs-comment">//注意这里Bean的名称是固定的，必须是multipartResolver</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> CommonsMultipartResolver <span class="hljs-title">commonsMultipartResolver</span><span class="hljs-params">()</span></span>&#123;<br>    CommonsMultipartResolver resolver = <span class="hljs-keyword">new</span> CommonsMultipartResolver();<br>    resolver.setMaxUploadSize(<span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">10</span>);   <span class="hljs-comment">//最大10MB大小</span><br>    resolver.setDefaultEncoding(<span class="hljs-string">&quot;UTF-8&quot;</span>);   <span class="hljs-comment">//默认编码格式</span><br>    <span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-meta">@Bean(&quot;multipartResolver&quot;)</span>   <span class="hljs-comment">//注意这里Bean的名称是固定的，必须是multipartResolver</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> CommonsMultipartResolver <span class="hljs-title">commonsMultipartResolver</span><span class="hljs-params">()</span></span>&#123;<br>    CommonsMultipartResolver resolver = <span class="hljs-keyword">new</span> CommonsMultipartResolver();<br>    resolver.setMaxUploadSize(<span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">10</span>);   <span class="hljs-comment">//最大10MB大小</span><br>    resolver.setDefaultEncoding(<span class="hljs-string">&quot;UTF-8&quot;</span>);   <span class="hljs-comment">//默认编码格式</span><br>    <span class="hljs-keyword">return</span> resolver;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>接着我们直接编写Controller即可：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/upload&quot;, method = RequestMethod.POST)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">upload</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam</span> CommonsMultipartFile file)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>    File fileObj = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;test.html&quot;</span>);<br>    file.transferTo(fileObj);<br>    System.out.println(<span class="hljs-string">&quot;用户上传的文件已保存到：&quot;</span>+fileObj.getAbsolutePath());<br>    <span class="hljs-keyword">return</span> <span class="hljs-string"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/upload&quot;, method = RequestMethod.POST)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">upload</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam</span> CommonsMultipartFile file)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>    File fileObj = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;test.html&quot;</span>);<br>    file.transferTo(fileObj);<br>    System.out.println(<span class="hljs-string">&quot;用户上传的文件已保存到：&quot;</span>+fileObj.getAbsolutePath());<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">"文件上传成功！"</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>使用CommonsMultipartFile对象来接收用户上传的文件。它是基于Apache的Commons-fileupload框架实现的，我们还需要导入一个依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre class=" language-hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-fileupload<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-fileupload<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name"><code class="language-hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-fileupload<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-fileupload<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>></span><br></code></pre></td></tr></table></figure>

<p>最后在前端添加一个文件的上传点：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre class=" language-hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;upload&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name"><code class="language-hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;upload&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>></span><br></code></pre></td></tr></table></figure>

<p>这样，点击提交之后，文件就会上传到服务器了。</p>
<p>下载其实和我们之前的写法大致一样，直接使用HttpServletResponse，并向输出流中传输数据即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/download&quot;, method = RequestMethod.GET)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">download</span><span class="hljs-params">(HttpServletResponse response)</span></span>&#123;<br>    response.setContentType(<span class="hljs-string">&quot;multipart/form-data&quot;</span>);<br>    <span class="hljs-keyword">try</span>(OutputStream stream = response.getOutputStream();<br>        InputStream inputStream = <span class="hljs-keyword">new</span> FileInputStream(<span class="hljs-string">&quot;test.html&quot;</span>))&#123;<br>        IOUtils.copy(inputStream, stream);<br>    &#125;<span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/download&quot;, method = RequestMethod.GET)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">download</span><span class="hljs-params">(HttpServletResponse response)</span></span>&#123;<br>    response.setContentType(<span class="hljs-string">&quot;multipart/form-data&quot;</span>);<br>    <span class="hljs-keyword">try</span>(OutputStream stream = response.getOutputStream();<br>        InputStream inputStream = <span class="hljs-keyword">new</span> FileInputStream(<span class="hljs-string">&quot;test.html&quot;</span>))&#123;<br>        IOUtils.copy(inputStream, stream);<br>    &#125;<span class="hljs-keyword">catch</span> (IOException e)&#123;<br>        e.printStackTrace();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在前端页面中添加一个下载点：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre class=" language-hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;download&quot;</span> <span class="hljs-attr">download</span>=<span class="hljs-string">&quot;test.html&quot;</span>&gt;</span>下载最新资源<span class="hljs-tag">&lt;/<span class="hljs-name"><code class="language-hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;download&quot;</span> <span class="hljs-attr">download</span>=<span class="hljs-string">&quot;test.html&quot;</span>&gt;</span>下载最新资源<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>></span><br></code></pre></td></tr></table></figure>

<h2 id="解读DispatcherServlet源码"><a href="#解读DispatcherServlet源码" class="headerlink" title="解读DispatcherServlet源码"></a>解读DispatcherServlet源码</h2><p><strong>注意：</strong>本部分作为选学内容！</p>
<p>到目前为止，关于SpringMVC的相关内容就学习得差不多了，但是我们在最后还是需要深入了解一下DispatcherServlet底层是如何进行调度的，因此，我们会从源码角度进行讲解。</p>
<p>首先我们需要找到<code>DispatcherServlet</code>的最顶层<code>HttpServletBean</code>，在这里直接继承的<code>HttpServlet</code>，那么我们首先来看一下，它在初始化方法中做了什么：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ServletException </span>&#123;<br>  	<span class="hljs-comment">//读取配置参数，并进行配置</span><br>    PropertyValues pvs = <span class="hljs-keyword">new</span> HttpServletBean.ServletConfigPropertyValues(<span class="hljs-keyword">this</span>.getServletConfig(), <span class="hljs-keyword">this</span>.requiredProperties);<br>    <span class="hljs-keyword">if</span> (!pvs.isEmpty()) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            BeanWrapper bw = PropertyAccessorFactory.forBeanPropertyAccess(<span class="hljs-keyword">this</span>);<br>            ResourceLoader resourceLoader = <span class="hljs-keyword">new</span> ServletContextResourceLoader(<span class="hljs-keyword">this</span>.getServletContext());<br>            bw.registerCustomEditor(Resource.class, <span class="hljs-keyword">new</span> ResourceEditor(resourceLoader, <span class="hljs-keyword">this</span>.getEnvironment()));<br>            <span class="hljs-keyword">this</span>.initBeanWrapper(bw);<br>            bw.setPropertyValues(pvs, <span class="hljs-keyword">true</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (BeansException var4) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.logger.isErrorEnabled()) &#123;<br>                <span class="hljs-keyword">this</span>.logger.error(<span class="hljs-string">&quot;Failed to set bean properties on servlet &#x27;&quot;</span> + <span class="hljs-keyword">this</span>.getServletName() + <span class="hljs-string">&quot;&#x27;&quot;</span>, var4);<br>            &#125;<br><br>            <span class="hljs-keyword">throw</span> var4;<br>        &#125;<br>    &#125;<br>		<span class="hljs-comment">//此初始化阶段由子类实现，</span><br>    <span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ServletException </span>&#123;<br>  	<span class="hljs-comment">//读取配置参数，并进行配置</span><br>    PropertyValues pvs = <span class="hljs-keyword">new</span> HttpServletBean.ServletConfigPropertyValues(<span class="hljs-keyword">this</span>.getServletConfig(), <span class="hljs-keyword">this</span>.requiredProperties);<br>    <span class="hljs-keyword">if</span> (!pvs.isEmpty()) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            BeanWrapper bw = PropertyAccessorFactory.forBeanPropertyAccess(<span class="hljs-keyword">this</span>);<br>            ResourceLoader resourceLoader = <span class="hljs-keyword">new</span> ServletContextResourceLoader(<span class="hljs-keyword">this</span>.getServletContext());<br>            bw.registerCustomEditor(Resource.class, <span class="hljs-keyword">new</span> ResourceEditor(resourceLoader, <span class="hljs-keyword">this</span>.getEnvironment()));<br>            <span class="hljs-keyword">this</span>.initBeanWrapper(bw);<br>            bw.setPropertyValues(pvs, <span class="hljs-keyword">true</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (BeansException var4) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.logger.isErrorEnabled()) &#123;<br>                <span class="hljs-keyword">this</span>.logger.error(<span class="hljs-string">&quot;Failed to set bean properties on servlet &#x27;&quot;</span> + <span class="hljs-keyword">this</span>.getServletName() + <span class="hljs-string">&quot;&#x27;&quot;</span>, var4);<br>            &#125;<br><br>            <span class="hljs-keyword">throw</span> var4;<br>        &#125;<br>    &#125;<br>		<span class="hljs-comment">//此初始化阶段由子类实现，</span><br>    <span class="hljs-keyword">this</span>.initServletBean();<br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们接着来看<code>initServletBean()</code>方法是如何实现的，它是在子类<code>FrameworkServlet</code>中定义的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initServletBean</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ServletException </span>&#123;<br>    <span class="hljs-keyword">this</span>.getServletContext().log(<span class="hljs-string">&quot;Initializing Spring &quot;</span> + <span class="hljs-keyword">this</span>.getClass().getSimpleName() + <span class="hljs-string">&quot; &#x27;&quot;</span> + <span class="hljs-keyword">this</span>.getServletName() + <span class="hljs-string">&quot;&#x27;&quot;</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.logger.isInfoEnabled()) &#123;<br>        <span class="hljs-keyword">this</span>.logger.info(<span class="hljs-string">&quot;Initializing Servlet &#x27;&quot;</span> + <span class="hljs-keyword">this</span>.getServletName() + <span class="hljs-string">&quot;&#x27;&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">long</span> startTime = System.currentTimeMillis();<br><br>    <span class="hljs-keyword">try</span> &#123;<br>      	<span class="hljs-comment">//注意：我们在一开始说了SpringMVC有两个容器，一个是Web容器一个是根容器</span><br>      	<span class="hljs-comment">//Web容器只负责Controller等表现层内容</span><br>      	<span class="hljs-comment">//根容器就是Spring容器，它负责Service、Dao等，并且它是Web容器的父容器。</span><br>      	<span class="hljs-comment">//初始化WebApplicationContext，这个阶段会为根容器和Web容器进行父子关系建立</span><br>        <span class="hljs-keyword">this</span>.webApplicationContext = <span class="hljs-keyword">this</span>.initWebApplicationContext();<br>        <span class="hljs-keyword">this</span>.initFrameworkServlet();<br>    &#125; <span class="hljs-keyword">catch</span> (RuntimeException | ServletException var4) &#123;<br>      <span class="hljs-comment"><code class="language-hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initServletBean</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ServletException </span>&#123;<br>    <span class="hljs-keyword">this</span>.getServletContext().log(<span class="hljs-string">&quot;Initializing Spring &quot;</span> + <span class="hljs-keyword">this</span>.getClass().getSimpleName() + <span class="hljs-string">&quot; &#x27;&quot;</span> + <span class="hljs-keyword">this</span>.getServletName() + <span class="hljs-string">&quot;&#x27;&quot;</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.logger.isInfoEnabled()) &#123;<br>        <span class="hljs-keyword">this</span>.logger.info(<span class="hljs-string">&quot;Initializing Servlet &#x27;&quot;</span> + <span class="hljs-keyword">this</span>.getServletName() + <span class="hljs-string">&quot;&#x27;&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">long</span> startTime = System.currentTimeMillis();<br><br>    <span class="hljs-keyword">try</span> &#123;<br>      	<span class="hljs-comment">//注意：我们在一开始说了SpringMVC有两个容器，一个是Web容器一个是根容器</span><br>      	<span class="hljs-comment">//Web容器只负责Controller等表现层内容</span><br>      	<span class="hljs-comment">//根容器就是Spring容器，它负责Service、Dao等，并且它是Web容器的父容器。</span><br>      	<span class="hljs-comment">//初始化WebApplicationContext，这个阶段会为根容器和Web容器进行父子关系建立</span><br>        <span class="hljs-keyword">this</span>.webApplicationContext = <span class="hljs-keyword">this</span>.initWebApplicationContext();<br>        <span class="hljs-keyword">this</span>.initFrameworkServlet();<br>    &#125; <span class="hljs-keyword">catch</span> (RuntimeException | ServletException var4) &#123;<br>      <span class="hljs-comment">//...以下内容全是打印日志</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://images2018.cnblogs.com/blog/1290804/201712/1290804-20171209164442730-1374080285.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>我们来看看<code>initWebApplicationContext</code>是如何进行初始化的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> WebApplicationContext <span class="hljs-title">initWebApplicationContext</span><span class="hljs-params">()</span> </span>&#123;<br>  	<span class="hljs-comment">//这里获取的是根容器，一般用于配置Service、数据源等</span><br>    WebApplicationContext rootContext = WebApplicationContextUtils.getWebApplicationContext(<span class="hljs-keyword">this</span>.getServletContext());<br>    WebApplicationContext wac = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.webApplicationContext != <span class="hljs-keyword">null</span>) &#123;<br>      	<span class="hljs-comment">//如果webApplicationContext在之前已经存在，则直接给到wac</span><br>        wac = <span class="hljs-keyword">this</span>.webApplicationContext;<br>        <span class="hljs-keyword">if</span> (wac <span class="hljs-keyword">instanceof</span> ConfigurableWebApplicationContext) &#123;<br>            ConfigurableWebApplicationContext cwac = (ConfigurableWebApplicationContext)wac;<br>            <span class="hljs-keyword">if</span> (!cwac.isActive()) &#123;<br>                <span class="hljs-keyword">if</span> (cwac.getParent() == <span class="hljs-keyword">null</span>) &#123;<br>                  	<span class="hljs-comment">//设定根容器为Web容器的父容器</span><br>                    cwac.setParent(rootContext);<br>                &#125;<br><br>                <span class="hljs-keyword">this</span>.configureAndRefreshWebApplicationContext(cwac);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (wac == <span class="hljs-keyword">null</span>) &#123;<br>      	<span class="hljs-comment">//如果webApplicationContext是空，那么就从ServletContext找一下有没有初始化上下文</span><br>        wac = <span class="hljs-keyword">this</span>.findWebApplicationContext();<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (wac == <span class="hljs-keyword">null</span>) &#123;<br>      	<span class="hljs-comment">//如果还是找不到，直接创个新的，并直接将根容器作为父容器</span><br>        wac = <span class="hljs-keyword">this</span>.createWebApplicationContext(rootContext);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.refreshEventReceived) &#123;<br>        <span class="hljs-keyword">synchronized</span>(<span class="hljs-keyword">this</span>.onRefreshMonitor) &#123;<br>          	<span class="hljs-comment">//此方法由DispatcherServlet实现</span><br>            <span class="hljs-keyword">this</span>.onRefresh(wac);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.publishContext) &#123;<br>        String attrName = <span class="hljs-keyword">this</span>.getServletContextAttributeName();<br>      	<span class="hljs-comment">//把Web容器丢进ServletContext</span><br>        <span class="hljs-keyword">this</span>.getServletContext().setAttribute(attrName, wac);<br>    &#125;<br><br>    <span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> WebApplicationContext <span class="hljs-title">initWebApplicationContext</span><span class="hljs-params">()</span> </span>&#123;<br>  	<span class="hljs-comment">//这里获取的是根容器，一般用于配置Service、数据源等</span><br>    WebApplicationContext rootContext = WebApplicationContextUtils.getWebApplicationContext(<span class="hljs-keyword">this</span>.getServletContext());<br>    WebApplicationContext wac = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.webApplicationContext != <span class="hljs-keyword">null</span>) &#123;<br>      	<span class="hljs-comment">//如果webApplicationContext在之前已经存在，则直接给到wac</span><br>        wac = <span class="hljs-keyword">this</span>.webApplicationContext;<br>        <span class="hljs-keyword">if</span> (wac <span class="hljs-keyword">instanceof</span> ConfigurableWebApplicationContext) &#123;<br>            ConfigurableWebApplicationContext cwac = (ConfigurableWebApplicationContext)wac;<br>            <span class="hljs-keyword">if</span> (!cwac.isActive()) &#123;<br>                <span class="hljs-keyword">if</span> (cwac.getParent() == <span class="hljs-keyword">null</span>) &#123;<br>                  	<span class="hljs-comment">//设定根容器为Web容器的父容器</span><br>                    cwac.setParent(rootContext);<br>                &#125;<br><br>                <span class="hljs-keyword">this</span>.configureAndRefreshWebApplicationContext(cwac);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (wac == <span class="hljs-keyword">null</span>) &#123;<br>      	<span class="hljs-comment">//如果webApplicationContext是空，那么就从ServletContext找一下有没有初始化上下文</span><br>        wac = <span class="hljs-keyword">this</span>.findWebApplicationContext();<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (wac == <span class="hljs-keyword">null</span>) &#123;<br>      	<span class="hljs-comment">//如果还是找不到，直接创个新的，并直接将根容器作为父容器</span><br>        wac = <span class="hljs-keyword">this</span>.createWebApplicationContext(rootContext);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.refreshEventReceived) &#123;<br>        <span class="hljs-keyword">synchronized</span>(<span class="hljs-keyword">this</span>.onRefreshMonitor) &#123;<br>          	<span class="hljs-comment">//此方法由DispatcherServlet实现</span><br>            <span class="hljs-keyword">this</span>.onRefresh(wac);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.publishContext) &#123;<br>        String attrName = <span class="hljs-keyword">this</span>.getServletContextAttributeName();<br>      	<span class="hljs-comment">//把Web容器丢进ServletContext</span><br>        <span class="hljs-keyword">this</span>.getServletContext().setAttribute(attrName, wac);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> wac;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们接着来看DispatcherServlet中实现的<code>onRefresh()</code>方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onRefresh</span><span class="hljs-params">(ApplicationContext context)</span> </span>&#123;<br>    initStrategies(context);<br>&#125;<br>    <br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initStrategies</span><span class="hljs-params">(ApplicationContext context)</span> </span>&#123;<br>  	<span class="hljs-comment">//初始化各种解析器</span><br>    initMultipartResolver(context);<br>    initLocaleResolver(context);<br>    initThemeResolver(context);<br>  	<span class="hljs-comment">//在容器中查找所有的HandlerMapping，放入集合中</span><br>  	<span class="hljs-comment">//HandlerMapping保存了所有的请求映射信息（Controller中定义的），它可以根据请求找到处理器Handler，但并不是简单的返回处理器，而是将处理器和拦截器封装，形成一个处理器执行链（类似于之前的Filter）</span><br>    initHandlerMappings(context);<br>  	<span class="hljs-comment">//在容器中查找所有的HandlerAdapter，它用于处理请求并返回ModelAndView对象</span><br>  	<span class="hljs-comment">//默认有三种实现HttpRequestHandlerAdapter，SimpleControllerHandlerAdapter和AnnotationMethodHandlerAdapter</span><br>  	<span class="hljs-comment">//当HandlerMapping找到处理请求的Controller之后，会选择一个合适的HandlerAdapter处理请求</span><br>  	<span class="hljs-comment">//比如我们之前使用的是注解方式配置Controller，现在有一个请求携带了一个参数，那么HandlerAdapter会对请求的数据进行解析，并传入方法作为实参，最后根据方法的返回值将其封装为ModelAndView对象</span><br>    initHandlerAdapters(context);<br>  	<span class="hljs-comment"><code class="language-hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onRefresh</span><span class="hljs-params">(ApplicationContext context)</span> </span>&#123;<br>    initStrategies(context);<br>&#125;<br>    <br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initStrategies</span><span class="hljs-params">(ApplicationContext context)</span> </span>&#123;<br>  	<span class="hljs-comment">//初始化各种解析器</span><br>    initMultipartResolver(context);<br>    initLocaleResolver(context);<br>    initThemeResolver(context);<br>  	<span class="hljs-comment">//在容器中查找所有的HandlerMapping，放入集合中</span><br>  	<span class="hljs-comment">//HandlerMapping保存了所有的请求映射信息（Controller中定义的），它可以根据请求找到处理器Handler，但并不是简单的返回处理器，而是将处理器和拦截器封装，形成一个处理器执行链（类似于之前的Filter）</span><br>    initHandlerMappings(context);<br>  	<span class="hljs-comment">//在容器中查找所有的HandlerAdapter，它用于处理请求并返回ModelAndView对象</span><br>  	<span class="hljs-comment">//默认有三种实现HttpRequestHandlerAdapter，SimpleControllerHandlerAdapter和AnnotationMethodHandlerAdapter</span><br>  	<span class="hljs-comment">//当HandlerMapping找到处理请求的Controller之后，会选择一个合适的HandlerAdapter处理请求</span><br>  	<span class="hljs-comment">//比如我们之前使用的是注解方式配置Controller，现在有一个请求携带了一个参数，那么HandlerAdapter会对请求的数据进行解析，并传入方法作为实参，最后根据方法的返回值将其封装为ModelAndView对象</span><br>    initHandlerAdapters(context);<br>  	<span class="hljs-comment">//其他的内容</span><br>    initHandlerExceptionResolvers(context);<br>    initRequestToViewNameTranslator(context);<br>    initViewResolvers(context);<br>    initFlashMapManager(context);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>DispatcherServlet初始化过程我们已经了解了，那么我们接着来看DispatcherServlet是如何进行调度的，首先我们的请求肯定会经过<code>HttpServlet</code>，然后其交给对应的doGet、doPost等方法进行处理，而在<code>FrameworkServlet</code>中，这些方法都被重写，并且使用<code>processRequest</code>来进行处理：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>    <span class="hljs-keyword">this</span>.processRequest(request, response);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>    <span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>    <span class="hljs-keyword">this</span>.processRequest(request, response);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPost</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>    <span class="hljs-keyword">this</span>.processRequest(request, response);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>我们来看看<code>processRequest</code>做了什么：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">processRequest</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>  	<span class="hljs-comment">//前期准备工作</span><br>    <span class="hljs-keyword">long</span> startTime = System.currentTimeMillis();<br>    Throwable failureCause = <span class="hljs-keyword">null</span>;<br>    LocaleContext previousLocaleContext = LocaleContextHolder.getLocaleContext();<br>    LocaleContext localeContext = <span class="hljs-keyword">this</span>.buildLocaleContext(request);<br>    RequestAttributes previousAttributes = RequestContextHolder.getRequestAttributes();<br>    ServletRequestAttributes requestAttributes = <span class="hljs-keyword">this</span>.buildRequestAttributes(request, response, previousAttributes);<br>    WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);<br>    asyncManager.registerCallableInterceptor(FrameworkServlet.class.getName(), <span class="hljs-keyword">new</span> FrameworkServlet.RequestBindingInterceptor());<br>    <span class="hljs-keyword">this</span>.initContextHolders(request, localeContext, requestAttributes);<br><br>    <span class="hljs-keyword">try</span> &#123;<br>      	<span class="hljs-comment">//重点在这里，这里进行了Service的执行，不过是在DispatcherServlet中定义的</span><br>        <span class="hljs-keyword">this</span>.doService(request, response);<br>    &#125; <span class="hljs-keyword">catch</span> (IOException | ServletException var16) &#123;<br>        <span class="hljs-comment"><code class="language-hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">processRequest</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>  	<span class="hljs-comment">//前期准备工作</span><br>    <span class="hljs-keyword">long</span> startTime = System.currentTimeMillis();<br>    Throwable failureCause = <span class="hljs-keyword">null</span>;<br>    LocaleContext previousLocaleContext = LocaleContextHolder.getLocaleContext();<br>    LocaleContext localeContext = <span class="hljs-keyword">this</span>.buildLocaleContext(request);<br>    RequestAttributes previousAttributes = RequestContextHolder.getRequestAttributes();<br>    ServletRequestAttributes requestAttributes = <span class="hljs-keyword">this</span>.buildRequestAttributes(request, response, previousAttributes);<br>    WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);<br>    asyncManager.registerCallableInterceptor(FrameworkServlet.class.getName(), <span class="hljs-keyword">new</span> FrameworkServlet.RequestBindingInterceptor());<br>    <span class="hljs-keyword">this</span>.initContextHolders(request, localeContext, requestAttributes);<br><br>    <span class="hljs-keyword">try</span> &#123;<br>      	<span class="hljs-comment">//重点在这里，这里进行了Service的执行，不过是在DispatcherServlet中定义的</span><br>        <span class="hljs-keyword">this</span>.doService(request, response);<br>    &#125; <span class="hljs-keyword">catch</span> (IOException | ServletException var16) &#123;<br>        <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>请各位一定要耐心，这些大型框架的底层一般都是层层套娃，因为这样写起来层次会更加清晰，那么我们来看看<code>DispatcherServlet</code>中是如何实现的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doService</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>   <span class="hljs-comment">//...</span><br>    <span class="hljs-keyword">try</span> &#123;<br>      	<span class="hljs-comment">//重点在这里，这才是整个处理过程中最核心的部分</span><br>        <span class="hljs-keyword">this</span>.doDispatch(request, response);<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment"><code class="language-hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doService</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>   <span class="hljs-comment">//...</span><br>    <span class="hljs-keyword">try</span> &#123;<br>      	<span class="hljs-comment">//重点在这里，这才是整个处理过程中最核心的部分</span><br>        <span class="hljs-keyword">this</span>.doDispatch(request, response);<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>终于找到最核心的部分了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre class=" language-hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doDispatch</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>    HttpServletRequest processedRequest = request;<br>    HandlerExecutionChain mappedHandler = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">boolean</span> multipartRequestParsed = <span class="hljs-keyword">false</span>;<br>    WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);<br><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            ModelAndView mv = <span class="hljs-keyword">null</span>;<br>            Object dispatchException = <span class="hljs-keyword">null</span>;<br><br>            <span class="hljs-keyword">try</span> &#123;<br>                processedRequest = <span class="hljs-keyword">this</span>.checkMultipart(request);<br>                multipartRequestParsed = processedRequest != request;<br>              	<span class="hljs-comment">//在HandlerMapping集合中寻找可以处理当前请求的HandlerMapping</span><br>                mappedHandler = <span class="hljs-keyword">this</span>.getHandler(processedRequest);<br>                <span class="hljs-keyword">if</span> (mappedHandler == <span class="hljs-keyword">null</span>) &#123;<br>                    <span class="hljs-keyword">this</span>.noHandlerFound(processedRequest, response);<br>                  	<span class="hljs-comment">//找不到HandlerMapping则无法进行处理</span><br>                    <span class="hljs-keyword">return</span>;<br>                &#125;<br><br>              	<span class="hljs-comment">//根据HandlerMapping提供的信息，找到可以处理的HandlerAdapter</span><br>                HandlerAdapter ha = <span class="hljs-keyword">this</span>.getHandlerAdapter(mappedHandler.getHandler());<br>                String method = request.getMethod();<br>                <span class="hljs-keyword">boolean</span> isGet = HttpMethod.GET.matches(method);<br>                <span class="hljs-keyword">if</span> (isGet || HttpMethod.HEAD.matches(method)) &#123;<br>                    <span class="hljs-keyword">long</span> lastModified = ha.getLastModified(request, mappedHandler.getHandler());<br>                    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">new</span> ServletWebRequest(request, response)).checkNotModified(lastModified) &amp;&amp; isGet) &#123;<br>                        <span class="hljs-keyword">return</span>;<br>                    &#125;<br>                &#125;<br><br>              	<span class="hljs-comment">//执行所有拦截器的preHandle()方法</span><br>                <span class="hljs-keyword">if</span> (!mappedHandler.applyPreHandle(processedRequest, response)) &#123;<br>                    <span class="hljs-keyword">return</span>;<br>                &#125;<br><br>              	<span class="hljs-comment">//使用HandlerAdapter进行处理（我们编写的请求映射方法在这个位置才真正地执行了）</span><br>              	<span class="hljs-comment">//HandlerAdapter会帮助我们将请求的数据进行处理，再来调用我们编写的请求映射方法</span><br>              	<span class="hljs-comment">//最后HandlerAdapter会将结果封装为ModelAndView返回给mv</span><br>                mv = ha.handle(processedRequest, response, mappedHandler.getHandler());<br>                <span class="hljs-keyword">if</span> (asyncManager.isConcurrentHandlingStarted()) &#123;<br>                    <span class="hljs-keyword">return</span>;<br>                &#125;<br><br>                <span class="hljs-keyword">this</span>.applyDefaultViewName(processedRequest, mv);<br>              	<span class="hljs-comment">//执行所有拦截器的postHandle()方法</span><br>                mappedHandler.applyPostHandle(processedRequest, response, mv);<br>            &#125; <span class="hljs-keyword">catch</span> (Exception var20) &#123;<br>                dispatchException = var20;<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable var21) &#123;<br>                dispatchException = <span class="hljs-keyword">new</span> NestedServletException(<span class="hljs-string">&quot;Handler dispatch failed&quot;</span>, var21);<br>            &#125;<br><br>          	<span class="hljs-comment">//最后处理结果，对视图进行渲染等，如果抛出异常会出现错误页面</span><br>            <span class="hljs-keyword">this</span>.processDispatchResult(processedRequest, response, mappedHandler, mv, (Exception)dispatchException);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception var22) &#123;<br>            <span class="hljs-keyword">this</span>.triggerAfterCompletion(processedRequest, response, mappedHandler, var22);<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable var23) &#123;<br>            <span class="hljs-keyword">this</span>.triggerAfterCompletion(processedRequest, response, mappedHandler, <span class="hljs-keyword">new</span> NestedServletException(<span class="hljs-string">&quot;Handler processing failed&quot;</span>, var23));<br>        &#125;<br><br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-keyword">if</span> (asyncManager.isConcurrentHandlingStarted()) &#123;<br>            <span class="hljs-keyword">if</span> (mappedHandler != <span class="hljs-keyword">null</span>) &#123;<br>                mappedHandler.applyAfterConcurrentHandlingStarted(processedRequest, response);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (multipartRequestParsed) &#123;<br>            <span class="hljs-keyword"><code class="language-hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doDispatch</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>    HttpServletRequest processedRequest = request;<br>    HandlerExecutionChain mappedHandler = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">boolean</span> multipartRequestParsed = <span class="hljs-keyword">false</span>;<br>    WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);<br><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            ModelAndView mv = <span class="hljs-keyword">null</span>;<br>            Object dispatchException = <span class="hljs-keyword">null</span>;<br><br>            <span class="hljs-keyword">try</span> &#123;<br>                processedRequest = <span class="hljs-keyword">this</span>.checkMultipart(request);<br>                multipartRequestParsed = processedRequest != request;<br>              	<span class="hljs-comment">//在HandlerMapping集合中寻找可以处理当前请求的HandlerMapping</span><br>                mappedHandler = <span class="hljs-keyword">this</span>.getHandler(processedRequest);<br>                <span class="hljs-keyword">if</span> (mappedHandler == <span class="hljs-keyword">null</span>) &#123;<br>                    <span class="hljs-keyword">this</span>.noHandlerFound(processedRequest, response);<br>                  	<span class="hljs-comment">//找不到HandlerMapping则无法进行处理</span><br>                    <span class="hljs-keyword">return</span>;<br>                &#125;<br><br>              	<span class="hljs-comment">//根据HandlerMapping提供的信息，找到可以处理的HandlerAdapter</span><br>                HandlerAdapter ha = <span class="hljs-keyword">this</span>.getHandlerAdapter(mappedHandler.getHandler());<br>                String method = request.getMethod();<br>                <span class="hljs-keyword">boolean</span> isGet = HttpMethod.GET.matches(method);<br>                <span class="hljs-keyword">if</span> (isGet || HttpMethod.HEAD.matches(method)) &#123;<br>                    <span class="hljs-keyword">long</span> lastModified = ha.getLastModified(request, mappedHandler.getHandler());<br>                    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">new</span> ServletWebRequest(request, response)).checkNotModified(lastModified) &amp;&amp; isGet) &#123;<br>                        <span class="hljs-keyword">return</span>;<br>                    &#125;<br>                &#125;<br><br>              	<span class="hljs-comment">//执行所有拦截器的preHandle()方法</span><br>                <span class="hljs-keyword">if</span> (!mappedHandler.applyPreHandle(processedRequest, response)) &#123;<br>                    <span class="hljs-keyword">return</span>;<br>                &#125;<br><br>              	<span class="hljs-comment">//使用HandlerAdapter进行处理（我们编写的请求映射方法在这个位置才真正地执行了）</span><br>              	<span class="hljs-comment">//HandlerAdapter会帮助我们将请求的数据进行处理，再来调用我们编写的请求映射方法</span><br>              	<span class="hljs-comment">//最后HandlerAdapter会将结果封装为ModelAndView返回给mv</span><br>                mv = ha.handle(processedRequest, response, mappedHandler.getHandler());<br>                <span class="hljs-keyword">if</span> (asyncManager.isConcurrentHandlingStarted()) &#123;<br>                    <span class="hljs-keyword">return</span>;<br>                &#125;<br><br>                <span class="hljs-keyword">this</span>.applyDefaultViewName(processedRequest, mv);<br>              	<span class="hljs-comment">//执行所有拦截器的postHandle()方法</span><br>                mappedHandler.applyPostHandle(processedRequest, response, mv);<br>            &#125; <span class="hljs-keyword">catch</span> (Exception var20) &#123;<br>                dispatchException = var20;<br>            &#125; <span class="hljs-keyword">catch</span> (Throwable var21) &#123;<br>                dispatchException = <span class="hljs-keyword">new</span> NestedServletException(<span class="hljs-string">&quot;Handler dispatch failed&quot;</span>, var21);<br>            &#125;<br><br>          	<span class="hljs-comment">//最后处理结果，对视图进行渲染等，如果抛出异常会出现错误页面</span><br>            <span class="hljs-keyword">this</span>.processDispatchResult(processedRequest, response, mappedHandler, mv, (Exception)dispatchException);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception var22) &#123;<br>            <span class="hljs-keyword">this</span>.triggerAfterCompletion(processedRequest, response, mappedHandler, var22);<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable var23) &#123;<br>            <span class="hljs-keyword">this</span>.triggerAfterCompletion(processedRequest, response, mappedHandler, <span class="hljs-keyword">new</span> NestedServletException(<span class="hljs-string">&quot;Handler processing failed&quot;</span>, var23));<br>        &#125;<br><br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-keyword">if</span> (asyncManager.isConcurrentHandlingStarted()) &#123;<br>            <span class="hljs-keyword">if</span> (mappedHandler != <span class="hljs-keyword">null</span>) &#123;<br>                mappedHandler.applyAfterConcurrentHandlingStarted(processedRequest, response);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (multipartRequestParsed) &#123;<br>            <span class="hljs-keyword">this</span>.cleanupMultipart(processedRequest);<br>        &#125;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>所以，根据以上源码分析得出最终的流程图：</p>
<p><img src="https://img2018.cnblogs.com/blog/1338162/201901/1338162-20190113192808388-307235311.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>虽然完成本章学习后，我们已经基本能够基于Spring去重新编写一个更加高级的图书管理系统了，但是登陆验证复杂的问题依然没有解决，如果我们依然按照之前的方式编写登陆验证，显然太过简单，它仅仅只是一个登陆，但是没有任何的权限划分或是加密处理，我们需要更加高级的权限校验框架来帮助我们实现登陆操作，下一章，我们会详细讲解如何使用更加高级的SpringSecurity框架来进行权限验证，并在学习的过程中，重写我们的图书管理系统。</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/04/23/1.html/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile"></span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/04/13/5.html/">
                        <span class="hidden-mobile"></span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>












  

  

  

  

  

  





<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
